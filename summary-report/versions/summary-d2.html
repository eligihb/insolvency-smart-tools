<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
Â  <meta charset="UTF-8">
Â  <title>×“×•"×— ××¡×›× ×œ×“×™×•×Ÿ ×¦×• ×©×™×§×•×</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <style>
Â  Â  :root {
Â  Â  Â  --primary: #0f766e;
Â  Â  Â  --border: #cbd5e1;
Â  Â  Â  --text: #0f172a;
Â  Â  Â  --bg-input: #ffffff;
Â  Â  Â  --bg-readonly: #f1f5f9;
Â  Â  Â  --danger: #ef4444;
Â  Â  Â  --success: #15803d;
Â  Â  Â  --focus-glow: rgba(15, 118, 110, 0.2);
Â  Â  }

Â  Â  * { box-sizing: border-box; outline: none; }

Â  Â  body {
Â  Â  Â  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
Â  Â  Â  direction: rtl;
Â  Â  Â  text-align: right;
Â  Â  Â  margin: 0;
Â  Â  Â  background: #f8fafc; /* Light gray background for screen */
Â  Â  Â  color: var(--text);
Â  Â  Â  font-size: 12px;
Â  Â  }

Â  Â  /* --- UI Structure --- */
Â  Â  .top-bar {
Â  Â  Â  background: var(--primary);
Â  Â  Â  color: white;
Â  Â  Â  padding: 10px;
Â  Â  Â  text-align: center;
Â  Â  Â  font-size: 16px;
Â  Â  Â  font-weight: 700;
Â  Â  Â  position: sticky;
Â  Â  Â  top: 0;
Â  Â  Â  z-index: 100;
Â  Â  Â  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
Â  Â  }

Â  Â  .page {
Â  Â  Â  max-width: 210mm; /* A4 Width */
Â  Â  Â  margin: 10px auto;
Â  Â  Â  background: white;
Â  Â  Â  padding: 15px;
Â  Â  Â  box-shadow: 0 0 10px rgba(0,0,0,0.05);
Â  Â  Â  border-radius: 4px;
Â  Â  }

Â  Â  .card {
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 6px;
Â  Â  Â  padding: 8px 10px;
Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  background: white;
Â  Â  }

Â  Â  /* --- Typography & Headers --- */
Â  Â  .section-title {
Â  Â  Â  font-size: 13px;
Â  Â  Â  font-weight: 800;
Â  Â  Â  color: var(--primary);
Â  Â  Â  border-bottom: 2px solid #e2e8f0;
Â  Â  Â  padding-bottom: 3px;
Â  Â  Â  margin-bottom: 6px;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  }

Â  Â  .sub-title {
Â  Â  Â  font-size: 11px;
Â  Â  Â  font-weight: 700;
Â  Â  Â  color: #334155;
Â  Â  Â  margin: 6px 0 2px;
Â  Â  Â  text-decoration: underline;
Â  Â  Â  text-decoration-color: var(--primary);
Â  Â  }

Â  Â  /* --- Inputs & Rows --- */
Â  Â  .row {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 8px; /* ×§×˜×Ÿ ×-8px */
Â  Â  Â  margin-bottom: 5px;
Â  Â  }
Â  Â  .row-compact {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: nowrap;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 4px; /* ×¨×•×•×— ×§×˜×Ÿ ×‘××™×•×—×“ */
Â  Â  Â  margin-bottom: 5px;
Â  Â  }

Â  Â  label {
Â  Â  Â  font-size: 11px;
Â  Â  Â  font-weight: 600;
Â  Â  Â  color: #475569;
Â  Â  Â  white-space: nowrap;
Â  Â  }

Â  Â  input[type="text"],
Â  Â  input[type="number"],
Â  Â  input[type="date"],
Â  Â  select,
Â  Â  textarea {
Â  Â  Â  font-family: inherit;
Â  Â  Â  font-size: 11px;
Â  Â  Â  padding: 3px 6px;
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 4px;
Â  Â  Â  background: var(--bg-input);
Â  Â  Â  color: #000;
Â  Â  Â  transition: all 0.2s;
Â  Â  Â  min-height: 24px; /* ××—×™×“×•×ª ×’×•×‘×” */
Â  Â  }

Â  Â  input:focus, select:focus, textarea:focus {
Â  Â  Â  border-color: var(--primary);
Â  Â  Â  box-shadow: 0 0 0 2px var(--focus-glow);
Â  Â  }

Â  Â  textarea { resize: vertical; min-height: 30px; width: 100%; }
Â  Â Â 
Â  Â  /* Disabled / Readonly states */
Â  Â  input:disabled, select:disabled, input[readonly] {
Â  Â  Â  background: var(--bg-readonly);
Â  Â  Â  color: #64748b;
Â  Â  Â  cursor: not-allowed;
Â  Â  Â  border-color: #e2e8f0;
Â  Â  }
Â  Â Â 
Â  Â  /* Special Logic: Locked section (Red border) */
Â  Â  .locked-section input,Â 
Â  Â  .locked-section select {
Â  Â  Â  border: 1px solid #fca5a5 !important; /* Light red border */
Â  Â  Â  background: #fff1f2 !important;
Â  Â  Â  color: #991b1b !important;
Â  Â  Â  pointer-events: none;
Â  Â  }

Â  Â  /* --- Specific Field Sizes --- */
Â  Â  .tiny { width: 40px; text-align: center; } /* 2 ×¡×¤×¨×•×ª */
Â  Â  .short { width: 80px; } /* 5 ×¡×¤×¨×•×ª */
Â  Â  .medium { width: 110px; } /* 7 ×¡×¤×¨×•×ª */
Â  Â  .long { width: 160px; }
Â  Â  .flex-1 { flex: 1; }
Â  Â  input[type="date"] { width: 130px; } /* ×ª××¨×™×š ×¨×—×‘ ×™×•×ª×¨ */

Â  Â  /* --- Utility Classes --- */
Â  Â  .currency-input { font-weight: 700; color: #1e3a8a; } /* Blue for money */
Â  Â  .text-green { color: var(--success); font-weight: 800; }
Â  Â  .text-red { color: var(--danger); font-weight: 800; }
Â  Â  .center-text { text-align: center; }

Â  Â  /* Wrapped Labels (For compact rows) */
Â  Â  .label-wrap {
Â  Â  Â  display: inline-flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  line-height: 1;
Â  Â  Â  text-align: center;
Â  Â  Â  font-size: 10px;
Â  Â  Â  justify-content: center;
Â  Â  Â  min-width: 40px;
Â  Â  Â  margin-left: 2px;
Â  Â  }

Â  Â  /* --- Grid Layouts --- */
Â  Â  .grid-2-col {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: 1fr 1.3fr;
Â  Â  Â  gap: 10px;
Â  Â  Â  align-items: start;
Â  Â  }

Â  Â  .recommendation-grid {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: repeat(5, 1fr);
Â  Â  Â  gap: 6px;
Â  Â  Â  background: #f1f5f9;
Â  Â  Â  padding: 6px;
Â  Â  Â  border-radius: 4px;
Â  Â  Â  margin-bottom: 4px;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â Â 
Â  Â  .recommendation-grid label { display: block; margin-bottom: 2px; font-size: 10px; }
Â  Â  .recommendation-grid input { width: 95%; text-align: center; font-weight: bold; }

Â  Â  /* --- Calculator/Iframe Styling --- */
Â  Â  .calculator-container {
Â  Â  Â  overflow: hidden;
Â  Â  Â  margin: 0 auto;
Â  Â  Â  width: 100%;
Â  Â  Â  transform-origin: top center;
Â  Â  Â  transform: scale(0.9); /* ×”×§×˜× ×” ×§×œ×” ×œ××¡×š */
Â  Â  Â  height: 280px; /* ×’×•×‘×” ×§×‘×•×¢ */
Â  Â  }
Â  Â  .calculator-container iframe {
Â  Â  Â  width: 111%; /* ××¤×¦×” ×¢×œ scale */
Â  Â  Â  height: 320px;
Â  Â  Â  border: none;
Â  Â  }
Â  Â Â 
Â  Â  /* --- Buttons --- */
Â  Â  .btn {
Â  Â  Â  border: none;
Â  Â  Â  padding: 4px 10px;
Â  Â  Â  border-radius: 4px;
Â  Â  Â  font-size: 11px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  font-weight: 600;
Â  Â  }
Â  Â  .btn-primary { background: white; color: var(--primary); font-weight: 700;}
Â  Â  .btn-print { background: #334155; color: white; }
Â  Â  .btn-reset { background: white; border: 1px solid var(--danger); color: var(--danger); }

Â  Â  /* --- PRINT STYLES --- */
Â  Â  @media print {
Â  Â  Â  @page { size: A4 portrait; margin: 6mm; }
Â  Â  Â  body { background: white; font-size: 10.5px; -webkit-print-color-adjust: exact; }
Â  Â  Â  .top-bar, .btn { display: none !important; }
Â  Â  Â  .page { padding: 0; box-shadow: none; max-width: 100%; margin: 0; border: none; }
Â  Â  Â  .card { border: none; border-bottom: 1px solid #000; padding: 2px 0; margin-bottom: 4px; border-radius: 0; box-shadow: none; }
Â  Â  Â  .section-title { color: #000; border-bottom: 2px solid #000; margin-bottom: 4px; font-size: 12px; }
Â  Â  Â  .sub-title { color: #000; text-decoration: none; font-weight: 800; margin-top: 4px; font-size: 10.5px; }
Â  Â  Â Â 
Â  Â  Â  input, select, textarea {
Â  Â  Â  Â  border: none;
Â  Â  Â  Â  border-bottom: 1px dotted #999;
Â  Â  Â  Â  background: transparent !important;
Â  Â  Â  Â  border-radius: 0;
Â  Â  Â  Â  padding: 0 2px;
Â  Â  Â  Â  min-height: auto;
Â  Â  Â  Â  color: #000 !important;
Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  /* Visual translation for screen colors */
Â  Â  Â  .text-green, .text-red { color: #000 !important; font-weight: 900; text-decoration: underline; }
Â  Â  Â  .locked-section input { border-bottom: 1px solid transparent !important; color: #ccc !important; }
Â  Â  Â Â 
Â  Â  Â  /* Layout fixes */
Â  Â  Â  .grid-2-col { gap: 8px; }
Â  Â  Â  .recommendation-grid { background: none; border: 1px solid #000; padding: 2px; }
Â  Â  Â  .recommendation-grid input { border-bottom: none; }
Â  Â  Â Â 
Â  Â  Â  /* Hide placeholders */
Â  Â  Â  ::placeholder { color: transparent; }
Â  Â  Â Â 
Â  Â  Â  /* Calculator print scale */
Â  Â  Â  .calculator-container {
Â  Â  Â  Â  transform: scale(0.9); /* × ×©××¨ ×›×“×™ ×œ×”×‘×˜×™×— ×›× ×™×¡×” ×œ×“×£ A4 */
Â  Â  Â  Â  height: 260px; /* ×¦××¦×•× ×’×•×‘×” ×‘×”×“×¤×¡×” */
Â  Â  Â  }
Â  Â  Â  .calculator-container iframe { width: 111%; height: 300px;}
Â  Â  }
Â  </style>
</head>
<body>

Â  <div class="top-bar">
Â  Â  <div style="max-width: 1000px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
Â  Â  Â  <span>×“×•"×— ××¡×›× ×œ×“×™×•×Ÿ ×¦×• ×©×™×§×•× (×˜×•×¤×¡ 1000)</span>
Â  Â  Â  <div style="display:flex; gap:10px;">
Â  Â  Â  Â  <button class="btn btn-reset" onclick="document.getElementById('mainForm').reset()">â†º ××™×¤×•×¡</button>
Â  Â  Â  Â  <button class="btn btn-primary" onclick="alert('×¦×™×œ×•× ××¡×š: ×™×© ×œ×”×©×ª××© ×‘×¤×•× ×§×¦×™×™×ª ×”×”×“×¤×¡×” ×•×‘×—×™×¨×ª ××“×¤×¡×ª PDF')">ğŸ“¸ ×¦×™×œ×•× ××¡×š</button>
Â  Â  Â  Â  <button class="btn btn-print" onclick="window.print()">ğŸ–¨ ×”×“×¤×¡×”</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <div class="page">
Â  Â  <form id="mainForm">
Â  Â  Â Â 
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="section-title">×¤×¨×˜×™ ×ª×™×§ ×•×¦×• ×ª×©×œ×•××™×</div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div style="display: flex; gap: 10px; justify-content: space-between;">
Â  Â  Â  Â  Â  <div style="flex: 1;">
Â  Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  Â  <label>×ª×™×§ ×××•× ×”:</label> <input type="text" class="short" maxlength="10">
Â  Â  Â  Â  Â  Â  Â  <label>×ª×™×§ ×‘×™×”×"×©:</label> <input type="text" class="short">
Â  Â  Â  Â  Â  Â  Â  <label>×©× ×”×—×™×™×‘:</label> <input type="text" class="medium">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  Â  <label>×©× ×”× ×××Ÿ:</label> <input type="text" class="medium">
Â  Â  Â  Â  Â  Â  Â  <label>×ª××¨×™×š ×¦×• ×›×™× ×•×¡:</label> <input type="date" id="orderDate">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <div style="flex: 1.2; border-right: 1px solid var(--border); padding-right: 10px;">
Â  Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  Â  <label>×ª×©×œ×•× ×—×•×“×©×™:</label>Â 
Â  Â  Â  Â  Â  Â  Â  <input type="text" id="monthlyPayment" class="short currency-input" placeholder="â‚ª">
Â  Â  Â  Â  Â  Â  Â  <label>× ×›×•×Ÿ ×œ×™×•×:</label>Â 
Â  Â  Â  Â  Â  Â  Â  <input type="date" id="calcDate">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  Â  <label>×ª×©×œ×•× ××“×•×¨×’:</label>Â 
Â  Â  Â  Â  Â  Â  Â  <input type="text" id="gradedPayment" class="short currency-input" placeholder="â‚ª">
Â  Â  Â  Â  Â  Â  Â  <label>×œ××©×š:</label>Â 
Â  Â  Â  Â  Â  Â  Â  <input type="number" id="gradedMonths" class="tiny" value="3" min="1">
Â  Â  Â  Â  Â  Â  Â  <span>×—×•×“×©×™× (××™×•× ×”×¦×•)</span>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="row-compact" style="background: #f0f9ff; padding: 4px; border-radius: 4px; border: 1px solid #bae6fd;">
Â  Â  Â  Â  Â  Â  Â  <label class="text-green">×¡×”"×› ×œ×ª×©×œ×•×:</label>Â 
Â  Â  Â  Â  Â  Â  Â  <input type="text" id="totalToPay" class="short currency-input" readonly>
Â  Â  Â  Â  Â  Â  Â  <label>×—×•×“×©×™× ××”×¦×•:</label>Â 
Â  Â  Â  Â  Â  Â  Â  <input type="text" id="monthsSinceOrder" class="tiny" readonly>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <hr style="border-top:1px dashed var(--border); margin: 6px 0;">
Â  Â  Â  Â  <div style="background: #fffbeb; padding: 4px 8px; border-radius: 4px; border: 1px solid #fde68a;">
Â  Â  Â  Â  Â  <div class="sub-title" style="margin-top:0;">×”×—×œ×˜×•×ª ×××•× ×” (×¢×“×›×•×Ÿ ×¦×•)</div>
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  <label>×ª××¨×™×š ×”×—×œ×˜×”:</label>
Â  Â  Â  Â  Â  Â  <input type="date" id="commDecDate">
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <label>×¡×›×•× ×§×‘×•×¢ ×—×“×©:</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="commNewFixed" class="short currency-input">
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div style="display:flex; align-items:center; background:white; border:1px solid #cbd5e1; padding:2px 4px; border-radius:4px;">
Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" id="useCustomDate" onchange="toggleField('commEffectiveDate', this.checked)">
Â  Â  Â  Â  Â  Â  Â  <label for="useCustomDate" style="font-size:10px; margin:0 4px;">×ª×—×•×œ×” ××•×ª×××ª</label>
Â  Â  Â  Â  Â  Â  Â  <input type="date" id="commEffectiveDate" disabled>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  <label style="font-weight:800;">×ª×©×œ×•× ××“×•×¨×’:</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="commGradedAmount" class="short currency-input" placeholder="×¡×›×•×">
Â  Â  Â  Â  Â  Â  <label>××™×•×:</label>
Â  Â  Â  Â  Â  Â  <input type="date" id="commGradedDate">
Â  Â  Â  Â  Â  Â  <label>×œ××©×š:</label>
Â  Â  Â  Â  Â  Â  <input type="number" id="commGradedMonths" class="tiny" placeholder="×—×•×“'">
Â  Â  Â  Â  Â  Â  <label>×”×¢×¨×•×ª:</label>
Â  Â  Â  Â  Â  Â  <input type="text" class="flex-1" placeholder="×”×¢×¨×•×ª ×œ×”×—×œ×˜×”...">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <div class="grid-2-col">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <div class="card" id="debtorIncomeBlock">
Â  Â  Â  Â  Â  Â  <div class="section-title">
Â  Â  Â  Â  Â  Â  Â  ×”×›× ×¡×•×ª ×”×—×™×™×‘
Â  Â  Â  Â  Â  Â  Â  <label style="font-size:10px;"><input type="checkbox" onchange="toggleLockSection('debtorData', this.checked)"> ×”×—×™×™×‘ ×œ× ×¢×•×‘×“</label>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="debtorData">
Â  Â  Â  Â  Â  Â  Â  <div class="row-compact" style="flex-wrap: nowrap;">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="short" placeholder="××§×¦×•×¢" id="debtorJob">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="medium" placeholder="××§×•× ×¢×‘×•×“×”">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="short" placeholder="×”×™×§×£ ××©×¨×”">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="debtorNet" class="short currency-input text-green" placeholder="×©×›×¨ × ×˜×•">
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  <div class="row">
Â  Â  Â  Â  Â  Â  Â  Â  <label>×¤×•×˜× ×¦×™××œ:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="short currency-input">
Â  Â  Â  Â  Â  Â  Â  Â  <label>×”×¢×¨×•×ª:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="flex-1">
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="row" style="margin-top:6px; font-size:10px;">
Â  Â  Â  Â  Â  Â  Â  <label><input type="checkbox"> × ×›×•×ª</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="checkbox"> ×”.×”×›× ×¡×”</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="checkbox"> ×¡×™×•×¢ ×©×›"×“</label>
Â  Â  Â  Â  Â  Â  Â  <label style="margin-right:auto;">×¡×”"×› ×§×¦×‘××•×ª:</label>
Â  Â  Â  Â  Â  Â  Â  <input type="text" id="totalAllow" class="short currency-input">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â <div class="section-title">
Â  Â  Â  Â  Â  Â  Â  ×”×›× ×¡×•×ª ×‘×Ÿ/×ª ×”×–×•×’
Â  Â  Â  Â  Â  Â  Â  <label style="font-size:10px;"><input type="checkbox" onchange="toggleLockSection('spouseData', this.checked)"> ×œ× ×¢×•×‘×“/×ª</label>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="spouseData" class="row">
Â  Â  Â  Â  Â  Â  Â  <input type="text" class="medium" placeholder="××§×¦×•×¢" id="spouseJob">
Â  Â  Â  Â  Â  Â  Â  <input type="text" id="spouseNet" class="short currency-input text-green" placeholder="×©×›×¨ × ×˜×•">
Â  Â  Â  Â  Â  Â  Â  <input type="text" class="flex-1" placeholder="×”×¢×¨×•×ª...">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="row" style="justify-content: flex-end; margin-top: 8px; border-top: 1px solid var(--border); padding-top: 4px;">
Â  Â  Â  Â  Â  Â  Â  Â <label>×¡×”"×› ×”×›× ×¡×•×ª:</label>
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" id="totalIncome" class="short currency-input text-green" readonly>
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â <div style="width: 20px;"></div> <label>×¡×”"×› ×”×•×¦××•×ª:</label>
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" id="totalExpenses" class="short currency-input text-red">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div class="section-title">×¤×¨×˜×™× ××™×©×™×™×</div>
Â  Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  Â  Â <label>××¦×‘ ××©×¤×—×ª×™:</label>
Â  Â  Â  Â  Â  Â  Â  Â <select class="short" id="maritalStatus"><option>× ×©×•×™</option><option>×¨×•×•×§</option><option>×’×¨×•×©</option></select>
Â  Â  Â  Â  Â  Â  Â  Â <label>×™×œ×“×™×:</label> <input type="number" class="tiny" id="numKids">
Â  Â  Â  Â  Â  Â  Â  Â <label>××–×•× ×•×ª:</label>Â 
Â  Â  Â  Â  Â  Â  Â  Â <input type="checkbox" id="chkAlimony" onchange="toggleField('valAlimony', this.checked)">
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" id="valAlimony" class="short currency-input" disabled>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div class="section-title">×”×ª× ×”×œ×•×ª ×•×—×•×‘×•×ª</div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="sub-title">×”×’×©×ª ×“×•×—×•×ª</div>
Â  Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="rep" checked> ×›×¡×“×¨×</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="rep"> ×—×œ×§×™</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="rep"> ×œ× ×”×•×’×©×•</label>
Â  Â  Â  Â  Â  Â  Â  <input type="text" class="flex-1" placeholder="×”×¢×¨×•×ª...">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="row-compact" style="background: #f8fafc; padding: 4px; border: 1px solid #e2e8f0; border-radius: 4px;">
Â  Â  Â  Â  Â  Â  Â  Â <div class="label-wrap">××¡××›×™×<br>×—×¡×¨×™×</div>
Â  Â  Â  Â  Â  Â  Â  Â <select class="tiny" style="width:45px;"><option>×œ×</option><option>×›×Ÿ</option></select>
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â <div style="width:10px; border-right:1px solid #ccc; height:20px; margin:0 4px;"></div>
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â <div class="label-wrap">×›××•×ª<br>×¤×™×’×•×¨×™×</div>
Â  Â  Â  Â  Â  Â  Â  Â <input type="number" class="tiny" id="lateCount">
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â <div class="label-wrap">×¡×š<br>×¤×™×’×•×¨×™×</div>
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" class="short currency-input text-red" id="lateAmount">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="sub-title">×—×•×‘×•×ª</div>
Â  Â  Â  Â  Â  Â  <div class="row-compact">
Â  Â  Â  Â  Â  Â  Â  <label>××¡' × ×•×©×™×:</label><input type="number" class="tiny">
Â  Â  Â  Â  Â  Â  Â  <label>×¡×›×•× ×—×•×‘:</label><input type="text" class="medium currency-input">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="row-compact" style="background: #fff1f2; padding: 3px; border-radius: 4px; justify-content: flex-start;">
Â  Â  Â  Â  Â  Â  Â  Â <label class="text-red">×“×™×Ÿ ×§×“×™××”:</label>
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" class="medium currency-input">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="row-compact" style="margin-top:4px;">
Â  Â  Â  Â  Â  Â  Â  Â <input type="checkbox" id="chkNonDis" onchange="toggleField('valNonDis', this.checked)">
Â  Â  Â  Â  Â  Â  Â  Â <label for="chkNonDis">×—×•×‘×•×ª ×œ× ×‘×¨×™ ×”×¤×˜×¨</label>
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" id="valNonDis" class="short currency-input" disabled>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="sub-title">× ×›×¡×™×</div>
Â  Â  Â  Â  Â  Â  <div class="row" style="align-items: flex-end;">
Â  Â  Â  Â  Â  Â  Â  Â <div class="label-wrap" style="text-align: right;">×“×™×¨×ª<br>××’×•×¨×™×</div>
Â  Â  Â  Â  Â  Â  Â  Â <input type="checkbox" style="margin-bottom: 5px;">
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" class="flex-1 currency-input" placeholder="×”×¢×¨×›×ª ×©×•×•×™">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â <div class="row">
Â  Â  Â  Â  Â  Â  Â  Â <label><input type="checkbox"> ×¨×›×‘</label>
Â  Â  Â  Â  Â  Â  Â  Â <label><input type="checkbox"> ×–×›×•×™×•×ª</label>
Â  Â  Â  Â  Â  Â  Â  Â <label><input type="checkbox"> ××—×¨</label>
Â  Â  Â  Â  Â  Â  Â  Â <input type="text" class="flex-1 currency-input" placeholder="×©×•×•×™ ××™××•×©">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="section-title">×¡×™×›×•× ×•×”××œ×¦×•×ª</div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="sub-title" style="margin-bottom:4px;">×ª×•×›× ×™×ª ×”× ×××Ÿ</div>
Â  Â  Â  Â  <div class="recommendation-grid">
Â  Â  Â  Â  Â  Â <div><label>×¡×›×•× ×—×•×“×©×™</label><input type="text" class="currency-input" id="trusM"></div>
Â  Â  Â  Â  Â  Â <div><label>×œ××©×š (×—×•×“×©×™×)</label><input type="number" id="trusD"></div>
Â  Â  Â  Â  Â  Â <div><label>×¡×”"×› ×ª×•×›× ×™×ª</label><input type="text" class="currency-input" id="trusTot" readonly style="background:#f0fdf4; font-weight: 800;"></div>
Â  Â  Â  Â  Â  Â <div><label>×ª×•×¡×¤×ª × ×›×¡×™×</label><input type="text" class="currency-input" id="trusAdd"></div>
Â  Â  Â  Â  Â  Â <div><label>×¡×”"×› ×œ×§×•×¤×”</label><input type="text" class="currency-input" id="trusGrand" readonly style="font-weight:900;"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <textarea rows="2" placeholder="×ª××¦×™×ª ×¢××“×ª ×”× ×××Ÿ..."></textarea>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <hr style="border-top:1px dashed #cbd5e1; margin:8px 0;">

Â  Â  Â  Â  <div class="sub-title" style="margin-bottom:4px;">×ª×•×›× ×™×ª ×”×××•× ×”</div>
Â  Â  Â  Â  <div class="recommendation-grid" style="background:#eef2ff;">
Â  Â  Â  Â  Â  Â <div><label>×¡×›×•× ×—×•×“×©×™</label><input type="text" class="currency-input" id="commM"></div>
Â  Â  Â  Â  Â  Â <div><label>×œ××©×š (×—×•×“×©×™×)</label><input type="number" id="commD"></div>
Â  Â  Â  Â  Â  Â <div><label>×¡×”"×› ×ª×•×›× ×™×ª</label><input type="text" class="currency-input" id="commTot" readonly style="background:#ffffff; font-weight: 800;"></div>
Â  Â  Â  Â  Â  Â <div><label>×ª×•×¡×¤×ª/×”×¢×¨×”</label><input type="text"></div> <div><label>×¡×”"×› ×œ×§×•×¤×”</label><input type="text" class="currency-input" id="commGrand" readonly style="font-weight:900;"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <textarea rows="2" placeholder="×ª××¦×™×ª ×¢××“×ª ×”×××•× ×”..."></textarea>
Â  Â  Â  </div>

Â  Â  Â  <div class="card" style="page-break-inside: avoid;">
Â  Â  Â  Â  <div class="sub-title">××—×©×‘×•×Ÿ ×¢×–×¨</div>
Â  Â  Â  Â  <div class="calculator-container">
Â  Â  Â  Â  Â  <iframe id="paymentCalculator" src="https://eligihb.github.io/insolvency-smart-tools/payment-order/versions/payment-order-a1.html"></iframe>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  </form>
Â  </div>

Â  <script>
Â  Â  /* --- LOGIC --- */
Â  Â Â 
Â  Â  // 1. Initialize Dates
Â  Â  document.addEventListener("DOMContentLoaded", () => {
Â  Â  Â  Â document.getElementById('calcDate').valueAsDate = new Date();
Â  Â  Â  Â addCurrencyListeners();
Â  Â  Â  Â addCalcListeners();
Â  Â  });

Â  Â  // 2. Generic Field Toggles
Â  Â  function toggleField(targetId, isChecked) {
Â  Â  Â  Â const el = document.getElementById(targetId);
Â  Â  Â  Â el.disabled = !isChecked;
Â  Â  Â  Â if (!isChecked) el.value = "";
Â  Â  Â  Â // Update iframe when relevant fields change
Â  Â  Â  Â if (targetId === 'valAlimony') {
Â  Â  Â  Â  Â  sendDataToIframe();
Â  Â  Â  Â }
Â  Â  }

Â  Â  function toggleLockSection(containerId, isChecked) {
Â  Â  Â  Â const container = document.getElementById(containerId);
Â  Â  Â  Â if (isChecked) {
Â  Â  Â  Â  Â  container.classList.add('locked-section');
Â  Â  Â  Â  Â  // Clear inputs inside
Â  Â  Â  Â  Â  container.querySelectorAll('input').forEach(i => i.value = "");
Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  container.classList.remove('locked-section');
Â  Â  Â  Â }
Â  Â  Â  Â calcTotals(); // Recalculate income
Â  Â  Â  Â sendDataToIframe();
Â  Â  }

Â  Â  // 3. Currency Formatting
Â  Â  function addCurrencyListeners() {
Â  Â  Â  Â document.querySelectorAll('.currency-input').forEach(input => {
Â  Â  Â  Â  Â  input.addEventListener('blur', function() {
Â  Â  Â  Â  Â  Â  Â const raw = this.value.replace(/[^\d.]/g, '');
Â  Â  Â  Â  Â  Â  Â if (raw) {
Â  Â  Â  Â  Â  Â  Â  Â  this.value = parseFloat(raw).toLocaleString('he-IL') + ' â‚ª';
Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  input.addEventListener('focus', function() {
Â  Â  Â  Â  Â  Â  Â this.value = this.value.replace(/[^\d.]/g, '');
Â  Â  Â  Â  Â  });
Â  Â  Â  Â });
Â  Â  }

Â  Â  function parseCurr(val) {
Â  Â  Â  Â if (!val) return 0;
Â  Â  Â  Â return parseFloat(val.replace(/[^\d.]/g, '')) || 0;
Â  Â  }

Â  Â  // 4. Recommendation Calculators
Â  Â  function addCalcListeners() {
Â  Â  Â  Â ['trus', 'comm'].forEach(prefix => {
Â  Â  Â  Â  Â  const m = document.getElementById(prefix+'M');
Â  Â  Â  Â  Â  const d = document.getElementById(prefix+'D');
Â  Â  Â  Â  Â  const add = document.getElementById(prefix+'Add');
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const run = () => {
Â  Â  Â  Â  Â  Â  Â const mon = parseCurr(m.value);
Â  Â  Â  Â  Â  Â  Â const dur = parseFloat(d.value) || 0;
Â  Â  Â  Â  Â  Â  Â const bonus = add ? parseCurr(add.value) : 0;
Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â const prog = mon * dur;
Â  Â  Â  Â  Â  Â  Â document.getElementById(prefix+'Tot').value = prog.toLocaleString() + ' â‚ª';
Â  Â  Â  Â  Â  Â  Â document.getElementById(prefix+'Grand').value = (prog + bonus).toLocaleString() + ' â‚ª';
Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  if(m) m.addEventListener('blur', run);
Â  Â  Â  Â  Â  if(d) d.addEventListener('input', run);
Â  Â  Â  Â  Â  if(add) add.addEventListener('blur', run);
Â  Â  Â  Â });

Â  Â  Â  Â // Main Payment Calculator Events
Â  Â  Â  Â const calcInputs = ['orderDate', 'calcDate', 'monthlyPayment', 'gradedPayment', 'gradedMonths',Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 'commDecDate', 'commNewFixed', 'useCustomDate', 'commEffectiveDate',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 'commGradedAmount', 'commGradedDate', 'commGradedMonths'];
Â  Â  Â  Â 
Â  Â  Â  Â calcInputs.forEach(id => {
Â  Â  Â  Â  Â  const el = document.getElementById(id);
Â  Â  Â  Â  Â  if(el) el.addEventListener('change', calculatePaymentTimeline);
Â  Â  Â  Â  Â  if(el && el.type === 'text') el.addEventListener('blur', calculatePaymentTimeline);
Â  Â  Â  Â });
Â  Â  Â  Â 
Â  Â  Â  Â // Income Totals & Iframe Data Sender
Â  Â  Â  Â const incomeInputs = ['debtorNet', 'spouseNet', 'totalAllow', 'valAlimony', 'maritalStatus', 'numKids'];
Â  Â  Â  Â incomeInputs.forEach(id => {
Â  Â  Â  Â  Â  const el = document.getElementById(id);
Â  Â  Â  Â  Â  if (el.type === 'number' || el.type === 'select-one') {
Â  Â  Â  Â  Â  Â  Â el.addEventListener('change', () => { calcTotals(); sendDataToIframe(); });
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â el.addEventListener('blur', () => { calcTotals(); sendDataToIframe(); });
Â  Â  Â  Â  Â  }
Â  Â  Â  Â });
Â  Â  }
Â  Â Â 
Â  Â  function calcTotals() {
Â  Â  Â  Â const d = parseCurr(document.getElementById('debtorNet').value);
Â  Â  Â  Â const s = parseCurr(document.getElementById('spouseNet').value);
Â  Â  Â  Â const a = parseCurr(document.getElementById('totalAllow').value);
Â  Â  Â  Â document.getElementById('totalIncome').value = (d+s+a).toLocaleString() + ' â‚ª';
Â  Â  }

Â  Â  // 5. Send Data to Iframe
Â  Â  function sendDataToIframe() {
Â  Â  Â  Â const iframe = document.getElementById('paymentCalculator');
Â  Â  Â  Â const targetOrigin = 'https://eligihb.github.io';
Â  Â  Â  Â 
Â  Â  Â  Â if (iframe && iframe.contentWindow) {
Â  Â  Â  Â  Â  Â const dataToSend = {
Â  Â  Â  Â  Â  Â  Â  Â type: 'syncFormData',
Â  Â  Â  Â  Â  Â  Â  Â // ×”×›× ×¡×•×ª ×•×§×¦×‘××•×ª
Â  Â  Â  Â  Â  Â  Â  Â DebtorIncome: parseCurr(document.getElementById('debtorNet').value),
Â  Â  Â  Â  Â  Â  Â  Â SpouseIncome: parseCurr(document.getElementById('spouseNet').value),
Â  Â  Â  Â  Â  Â  Â  Â Allowances: parseCurr(document.getElementById('totalAllow').value),
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // × ×ª×•× ×™× ××™×©×™×™×
Â  Â  Â  Â  Â  Â  Â  Â MaritalStatus: document.getElementById('maritalStatus').value,
Â  Â  Â  Â  Â  Â  Â  Â NumKids: parseInt(document.getElementById('numKids').value) || 0,
Â  Â  Â  Â  Â  Â  Â  Â Alimony: parseCurr(document.getElementById('valAlimony').value),
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // × ×ª×•× ×™ ×¤×™×’×•×¨×™× (×× ×”××—×©×‘×•×Ÿ ×™×•×“×¢ ×œ×¢×‘×“)
Â  Â  Â  Â  Â  Â  Â  Â LatePaymentCount: parseInt(document.getElementById('lateCount').value) || 0,
Â  Â  Â  Â  Â  Â  Â  Â LatePaymentAmount: parseCurr(document.getElementById('lateAmount').value),
Â  Â  Â  Â  Â  Â };
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â iframe.contentWindow.postMessage(dataToSend, targetOrigin);
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â // console.log('Data sent to iframe:', dataToSend);
Â  Â  Â  Â }
Â  Â  }

Â  Â  // 6. THE TIMELINE CALCULATOR (Original logic kept as is)
Â  Â  function calculatePaymentTimeline() {
Â  Â  Â  Â const orderDateStr = document.getElementById('orderDate').value;
Â  Â  Â  Â const calcDateStr = document.getElementById('calcDate').value;
Â  Â  Â  Â 
Â  Â  Â  Â if (!orderDateStr || !calcDateStr) return;
Â  Â  Â  Â 
Â  Â  Â  Â const start = new Date(orderDateStr);
Â  Â  Â  Â const end = new Date(calcDateStr);
Â  Â  Â  Â const firstPaymentMonth = new Date(start);Â 
Â  Â  Â  Â firstPaymentMonth.setMonth(start.getMonth() + 1); // +30 days approx
Â  Â  Â  Â 
Â  Â  Â  Â let totalToPay = 0;
Â  Â  Â  Â let monthsCount = 0;
Â  Â  Â  Â 
Â  Â  Â  Â // Parse Basic Data
Â  Â  Â  Â const baseMonthly = parseCurr(document.getElementById('monthlyPayment').value);
Â  Â  Â  Â const baseGraded = parseCurr(document.getElementById('gradedPayment').value);
Â  Â  Â  Â const baseGradedMonths = parseInt(document.getElementById('gradedMonths').value) || 3;
Â  Â  Â  Â 
Â  Â  Â  Â // Parse Commissioner Data
Â  Â  Â  Â const commDecDateStr = document.getElementById('commDecDate').value;
Â  Â  Â  Â const commFixed = parseCurr(document.getElementById('commNewFixed').value);
Â  Â  Â  Â const useCustom = document.getElementById('useCustomDate').checked;
Â  Â  Â  Â const commEffStr = document.getElementById('commEffectiveDate').value;
Â  Â  Â  Â 
Â  Â  Â  Â // Determine Effective Date for Fixed Change
Â  Â  Â  Â let commEffectiveDate = null;
Â  Â  Â  Â if (commFixed > 0 && commDecDateStr) {
Â  Â  Â  Â  Â  Â commEffectiveDate = new Date(useCustom && commEffStr ? commEffStr : commDecDateStr);
Â  Â  Â  Â }
Â  Â  Â  Â 
Â  Â  Â  Â // Parse Commissioner Graded
Â  Â  Â  Â const commGradedAmt = parseCurr(document.getElementById('commGradedAmount').value);
Â  Â  Â  Â const commGradedStartStr = document.getElementById('commGradedDate').value;
Â  Â  Â  Â const commGradedDur = parseInt(document.getElementById('commGradedMonths').value) || 0;
Â  Â  Â  Â 
Â  Â  Â  Â let commGradedStart = null;
Â  Â  Â  Â let commGradedEnd = null;
Â  Â  Â  Â 
Â  Â  Â  Â if (commGradedAmt > 0 && commGradedStartStr && commGradedDur > 0) {
Â  Â  Â  Â  Â  Â commGradedStart = new Date(commGradedStartStr);
Â  Â  Â  Â  Â  Â commGradedEnd = new Date(commGradedStart);
Â  Â  Â  Â  Â  Â commGradedEnd.setMonth(commGradedEnd.getMonth() + commGradedDur);
Â  Â  Â  Â }

Â  Â  Â  Â // Iterator
Â  Â  Â  Â let current = new Date(firstPaymentMonth);
Â  Â  Â  Â current.setDate(1); // Normalise to 1st of month for comparison
Â  Â  Â  Â 
Â  Â  Â  Â // Limit loop to avoid infinite (safety)
Â  Â  Â  Â let safeguard = 0;
Â  Â  Â  Â 
Â  Â  Â  Â while (current <= end && safeguard < 200) {
Â  Â  Â  Â  Â  Â monthsCount++;
Â  Â  Â  Â  Â  Â let monthAmount = 0;
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â // Logic Hierarchy:
Â  Â  Â  Â  Â  Â // 1. Commissioner Graded (Specific temporary change)
Â  Â  Â  Â  Â  Â // 2. Commissioner Fixed (Permanent change from effective date)
Â  Â  Â  Â  Â  Â // 3. Original Graded
Â  Â  Â  Â  Â  Â // 4. Original Fixed
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â let isCommGraded = false;
Â  Â  Â  Â  Â  Â if (commGradedStart && commGradedEnd) {
Â  Â  Â  Â  Â  Â  Â  Â if (current >= commGradedStart && current < commGradedEnd) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â monthAmount = commGradedAmt;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â isCommGraded = true;
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â if (!isCommGraded) {
Â  Â  Â  Â  Â  Â  Â  Â let isCommFixed = false;
Â  Â  Â  Â  Â  Â  Â  Â if (commEffectiveDate) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (current >= commEffectiveDate) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â monthAmount = commFixed;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â isCommFixed = true;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â if (!isCommFixed) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // Check Original Graded
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // How many months from FIRST payment?
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // Note: Logic says "from order date", but usually payment starts +1 month.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (monthsCount <= baseGradedMonths && baseGraded > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â monthAmount = baseGraded;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â monthAmount = baseMonthly;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â totalToPay += monthAmount;
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â // Next Month
Â  Â  Â  Â  Â  Â current.setMonth(current.getMonth() + 1);
Â  Â  Â  Â  Â  Â safeguard++;
Â  Â  Â  Â }
Â  Â  Â  Â 
Â  Â  Â  Â document.getElementById('monthsSinceOrder').value = monthsCount;
Â  Â  Â  Â document.getElementById('totalToPay').value = totalToPay.toLocaleString() + ' â‚ª';
Â  Â  }

Â  </script>
</body>
</html>
