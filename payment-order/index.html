<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™× - ×’×¨×¡×ª 2026 ×”××œ××”</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
:root{
  --primary:#005f73; --secondary:#0a9396; --bg:#f8fafc; --panel:#fff;
  --text:#1e293b; --label:#475569; --border:#cbd5e1; --accent:#ee9b00;
  --danger:#be123c; --blue:#2563eb; --muted:#94a3b8;
  --maxw:920px;
}

*{box-sizing:border-box}
body{
  font-family:'Heebo',sans-serif; background:var(--bg); color:var(--text);
  margin:0; padding:15px; display:flex; justify-content:center; min-height:100vh;
}

.calculator{width:100%; max-width:var(--maxw); background:#fff; border-radius:16px; box-shadow:0 12px 30px rgba(0,0,0,0.08); overflow:hidden;}

header{ background:var(--primary); color:#fff; padding:15px; text-align:center; }
header h1{margin:0; font-size:1.4rem;}

.board{ display:grid; grid-template-columns: 1.1fr 0.9fr; }

.inputs-col{ padding:20px; border-inline-end: 1px solid #e2e8f0; }
.results-col{ padding:20px; background:#f1f5f9; }

.section-title{
  margin:15px 0 10px; color:var(--primary); font-size:1rem; font-weight:700;
  display:flex; align-items:center; gap:8px; border-bottom:2px solid #e2e8f0; padding-bottom:5px;
}

/* ×›×¤×ª×•×¨×™× */
.toggles-line{display:flex; gap:8px; margin:10px 0; flex-wrap:wrap;}
.chip{
  padding:8px 12px; border:1px solid var(--border); border-radius:8px;
  background:#fff; cursor:pointer; font-size:0.85rem; font-weight:500;
  transition: 0.2s; flex:1; display:flex; justify-content:center; align-items:center;
}
.chip.active{background:var(--secondary); color:#fff; border-color:var(--secondary);}
.chip:hover:not(.active){background:#f1f5f9;}

/* ×©×“×•×ª ×§×œ×˜ */
.input-group{margin-bottom:12px;}
.input-group label{font-weight:600; color:var(--label); font-size:0.85rem; margin-bottom:4px; display:flex; align-items:center; gap:4px;}
input, select, textarea{
  border:1px solid var(--border); padding:10px; border-radius:8px; font-size:0.95rem; width:100%; outline:none;
}

.kids-wrapper{display:flex; align-items:center; gap:5px; max-width:140px;}
.small-input{width:50px !important; text-align:center; padding:5px;}
.btn-plus{
  width:32px; height:32px; border-radius:6px; border:1px solid var(--border); 
  background:#fff; cursor:pointer; font-weight:bold;
}

.note-input{
  margin-top:5px; font-size:0.8rem; border:1px dashed #cbd5e1; height:40px; background:#fffdf5; resize:none; padding:5px;
}

/* ×ª×•×¦××•×ª */
.card{
  background:#fff; border:1px solid #e2e8f0; border-radius:12px; padding:12px; text-align:center;
  box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom:10px;
}
.card .k{color:var(--muted); font-size:0.8rem; margin-bottom:4px;}
.card .v{font-weight:700; color:var(--primary); font-size:1.1rem;}

/* ×¡×¨×’×œ ××—×•×–×™× */
.ratio-bar{
  height:10px; border-radius:5px; background:#e2e8f0; overflow:hidden; display:flex; margin:10px 0;
}
.bar-d{background:var(--primary); transition:0.3s;}
.bar-p{background:var(--secondary); transition:0.3s;}

/* ×× ×’× ×•×Ÿ ×©×™× ×•×™ ×¡×›×•× ×¡×•×¤×™ */
.final-card{background:var(--primary) !important; color:#fff !important; position:relative;}
.final-card .k{color:rgba(255,255,255,0.8) !important;}
.final-val{font-size:1.7rem !important; display:block; margin:5px 0;}
.calc-original{font-size:0.75rem; color:rgba(255,255,255,0.6); text-decoration:line-through; margin-top:5px;}
.manual-input-area{margin-top:10px; border-top:1px solid rgba(255,255,255,0.2); padding-top:10px; display:none;}
.manual-input-area input{color:#000; text-align:center; font-weight:700;}

.info-icon{
  cursor:help; color:var(--muted); background:#e2e8f0; width:16px; height:16px; 
  border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-size:0.7rem;
}

@media (max-width:800px){ .board{grid-template-columns:1fr;} .inputs-col{border-inline-end:none;} }
</style>
</head>
<body>

<div class="calculator" id="calcRoot">
  <header><h1>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™×</h1></header>

  <div class="board">
    <div class="inputs-col">
      <div class="section-title">ğŸ‘¤ × ×ª×•× ×™ ×™×¡×•×“</div>
      <div class="input-group">
        <label>×¡×˜×˜×•×¡ ××©×¤×—×ª×™</label>
        <div class="toggles-line">
          <button class="chip family-type active" data-val="×™×—×™×“">×™×—×™×“</button>
          <button class="chip family-type" data-val="×¨×•×•×§_×™×œ×“">×¨×•×•×§/×’×¨×•×©+×™×œ×“</button>
          <button class="chip family-type" data-val="×–×•×’">×–×•×’</button>
        </div>
      </div>

      <div style="display:flex; gap:15px; align-items:flex-end">
        <div class="input-group">
          <label>××¡×¤×¨ ×™×œ×“×™×</label>
          <div class="kids-wrapper">
            <button class="btn-plus" onclick="changeKids(-1)">-</button>
            <input id="kidsCount" type="number" value="0" class="small-input" readonly>
            <button class="btn-plus" onclick="changeKids(1)">+</button>
          </div>
        </div>
        <div class="input-group" style="flex-grow:1">
          <label>××™ ×‘×”×œ×™×š?</label>
          <div class="toggles-line" style="margin:0">
            <button class="chip active" id="genM" onclick="setGen('×—×™×™×‘')">×—×™×™×‘</button>
            <button class="chip" id="genF" onclick="setGen('×—×™×™×‘×ª')">×—×™×™×‘×ª</button>
          </div>
        </div>
      </div>

      <div class="section-title">ğŸ’° ×”×›× ×¡×•×ª × ×˜×• (â‚ª)</div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px">
        <div class="input-group">
          <label id="lblSalD">×©×›×¨ (×—×™×™×‘) <span class="info-icon" title="×©×›×¨ × ×˜×• ×œ××—×¨ × ×™×›×•×™×™ ×—×•×‘×”: ××¡, ×¤× ×¡×™×” ×•×›×•'.">?</span></label>
          <input id="salD" type="number" oninput="calc()">
        </div>
        <div class="input-group">
          <label id="lblSalP">×©×›×¨ (×‘×Ÿ ×–×•×’) <span class="info-icon" title="×”×›× ×¡×ª ×‘×Ÿ ×”×–×•×’ ×œ×—×™×©×•×‘ × ×˜×œ ××—×™×™×” ×™×—×¡×™.">?</span></label>
          <input id="salP" type="number" oninput="calc()">
        </div>
      </div>

      <div class="input-group">
        <label>×”×›× ×¡×•×ª × ×•×¡×¤×•×ª <span class="info-icon" title="×©×›×™×¨×•×ª, ×‘×•× ×•×¡×™× ××• ×¢×¡×§.">?</span></label>
        <input id="otherInc" type="number" oninput="calc()">
        <textarea class="note-input" id="otherIncNote" placeholder="×¤×™×¨×•×˜ ××§×•×¨ ×”×”×›× ×¡×”..."></textarea>
      </div>

      <button class="chip" style="width:100%; margin:10px 0; background:#f1f5f9" onclick="toggleSec('allowBox')">ğŸ¦ ×§×¦×‘××•×ª ×‘×™×˜×•×— ×œ××•××™</button>
      <div id="allowBox" style="display:none; background:#f8fafc; padding:10px; border-radius:10px; border:1px solid #e2e8f0;">
        <div id="allowList"></div>
        <button class="chip" style="font-size:0.75rem; margin-top:5px" onclick="addAllow()">+ ×”×•×¡×£ ×§×¦×‘×”</button>
      </div>

      <div class="section-title">ğŸ“‰ ×”×•×¦××•×ª ×•×”×¤×—×ª×•×ª</div>
      <div class="toggles-line">
        <button class="chip" id="btnJoint" onclick="toggleJoint()">×©× ×™ ×‘× ×™ ×–×•×’ ×‘×”×œ×™×š</button>
        <button class="chip" id="btnSpec" onclick="toggleSec('specBox')">×”×•×¦××•×ª ××™×•×—×“×•×ª</button>
      </div>

      <div id="jointBox" style="display:none; margin-bottom:12px">
        <div class="input-group">
          <label>×ª×©×œ×•× ×‘×ª×™×§ ×¨××©×•×Ÿ ×‘×–××Ÿ (â‚ª)</label>
          <input id="firstCase" type="number" oninput="calc()">
        </div>
      </div>

      <div id="specBox" style="display:none; background:#fff1f2; padding:10px; border-radius:10px;">
        <div class="input-group">
          <label>×¦×”×¨×•× ×™×/×˜×™×¤×•×œ <span class="info-icon" title="×ª×§×¨×” ×œ×¦×”×¨×•×Ÿ: 1,000 â‚ª. ×˜×™×¤×•×œ ××ª×—×ª ×œ×’×™×œ ×—×•×‘×”: 2,500 â‚ª.">?</span></label>
          <input id="expChild" type="number" oninput="calc()">
        </div>
        <div class="input-group">
          <label>×”×•×¦××•×ª ×¨×¤×•××™×•×ª <span class="info-icon" title="×˜×™×¤×•×œ×™× ×•×ª×¨×•×¤×•×ª ×©××™× × ××›×•×¡×™×.">?</span></label>
          <input id="expMed" type="number" oninput="calc()">
        </div>
      </div>
    </div>

    <div class="results-col">
      <div class="section-title">ğŸ“Š ×¡×™×›×•× ×—×™×©×•×‘</div>
      
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
        <div class="card"><div class="k">×¡×”"×› ×”×›× ×¡×•×ª</div><div class="v" id="resInc">â‚ª 0</div></div>
        <div class="card"><div class="k">×“××™ ××—×™×™×”</div><div class="v" id="resLiv">â‚ª 0</div></div>
      </div>
      
      <div class="card"><div class="k">×”×›× ×¡×” ×¤× ×•×™×” ×œ×ª× ×”××©×¤×—×ª×™</div><div class="v" id="resDisp">â‚ª 0</div></div>

      <div style="margin:10px 0">
        <div style="display:flex; justify-content:space-between; font-size:0.75rem; font-weight:600">
          <span id="ratioD">×—×™×™×‘: 0%</span> <span id="ratioP">×‘×Ÿ ×–×•×’: 0%</span>
        </div>
        <div class="ratio-bar">
          <div id="barD" class="bar-d" style="width:50%"></div> <div id="barP" class="bar-p" style="width:50%"></div>
        </div>
      </div>

      <div class="card final-card">
        <div class="k">×¡×›×•× ×—×•×“×©×™ ×©× ×§×‘×¢</div>
        <span class="final-val" id="resFinal">â‚ª 0</span>
        <div id="calcOrigArea" style="display:none">
          <span class="calc-original" id="resCalcOrig"></span>
        </div>
        
        <button class="chip" id="btnManual" style="margin-top:10px; font-size:0.7rem; color:#000" onclick="toggleSec('manualArea')">âš™ï¸ ×©× ×” ×¡×›×•× ×™×“× ×™×ª</button>
        
        <div id="manualArea" class="manual-input-area">
          <div class="input-group">
            <label style="color:#fff; justify-content:center">×”×–×Ÿ ×¡×›×•× ×—×“×© ×©× ×§×‘×¢</label>
            <input id="manualAmt" type="number" placeholder="×¡×›×•× ×‘×©×§×œ×™×" oninput="calc()">
          </div>
        </div>
      </div>

      <div class="section-title">ğŸ“ ×”×¡×‘×¨ ×•×”×¢×¨×•×ª</div>
      <textarea id="finalNote" style="height:110px" placeholder="×›×ª×•×‘ ×›××Ÿ ××ª ×”× ×™××•×§×™× ×œ×§×‘×™×¢×ª ×”×¡×›×•× (×—×•×‘×” ×œ× ××§ ×‘××§×¨×” ×©×œ ×©×™× ×•×™ ×™×“× ×™)..."></textarea>

      <div class="toggles-line" style="margin-top:15px">
        <button class="chip" onclick="window.print()">ğŸ–¨ï¸ ×”×“×¤×¡×”</button>
        <button class="chip" style="color:var(--danger)" onclick="location.reload()">â†º ××™×¤×•×¡</button>
      </div>
    </div>
  </div>
</div>

<script>
const fmt = (n) => new Intl.NumberFormat('he-IL').format(Math.max(0, n || 0)) + ' â‚ª';
let gender = '×—×™×™×‘', isJoint = false, familyVal = '×™×—×™×“';

function toggleSec(id) {
  const el = document.getElementById(id);
  el.style.display = el.style.display === 'none' ? 'block' : 'none';
}

function changeKids(v) {
  const i = document.getElementById('kidsCount');
  let val = parseInt(i.value) + v;
  if (val < 0) val = 0;
  i.value = val;
  calc();
}

function toggleJoint() {
  isJoint = !isJoint;
  document.getElementById('btnJoint').classList.toggle('active', isJoint);
  document.getElementById('jointBox').style.display = isJoint ? 'block' : 'none';
  calc();
}

function setGen(g) {
  gender = g;
  document.getElementById('genM').classList.toggle('active', g === '×—×™×™×‘');
  document.getElementById('genF').classList.toggle('active', g === '×—×™×™×‘×ª');
  document.getElementById('lblSalD').childNodes[0].textContent = `×©×›×¨ (${g}) `;
  calc();
}

document.querySelectorAll('.family-type').forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll('.family-type').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    familyVal = btn.dataset.val;
    calc();
  }
});

function addAllow() {
  const div = document.createElement('div');
  div.className = 'toggles-line'; div.style.marginBottom = '5px';
  div.innerHTML = `<select style="flex:1"><option>× ×›×•×ª</option><option>×–×§× ×”</option><option>××‘×˜×œ×”</option><option>×™×œ×“×™×</option><option>××—×¨</option></select><input type="number" style="width:90px" oninput="calc()" placeholder="â‚ª"><button class="info-icon" onclick="this.parentElement.remove();calc()">X</button>`;
  document.getElementById('allowList').appendChild(div);
}

function calc() {
  const sD = parseFloat(document.getElementById('salD').value) || 0;
  const sP = parseFloat(document.getElementById('salP').value) || 0;
  const oI = parseFloat(document.getElementById('otherInc').value) || 0;
  let totalAllow = 0;
  document.querySelectorAll('#allowList input').forEach(i => totalAllow += parseFloat(i.value) || 0);
  
  const totalInc = sD + sP + oI + totalAllow;
  const kids = parseInt(document.getElementById('kidsCount').value) || 0;
  const livingBase = familyVal === '×™×—×™×“' ? 4556 : (familyVal === '×–×•×’' ? 6024 : 6056);
  const livingTotal = livingBase + (kids <= 4 ? kids * 1500 : (4 * 1500 + (kids - 4) * 1300));
  
  const eM = parseFloat(document.getElementById('expMed').value) || 0;
  const eC = parseFloat(document.getElementById('expChild').value) || 0;
  
  let disp = totalInc - livingTotal - eM - eC;
  if (isJoint) disp -= (parseFloat(document.getElementById('firstCase').value) || 0);

  const ratioDVal = totalInc > 0 ? (sD + oI/2 + totalAllow/2) / totalInc : 0;
  const percD = (ratioDVal * 100).toFixed(0);
  document.getElementById('barD').style.width = percD + '%';
  document.getElementById('barP').style.width = (100 - percD) + '%';
  document.getElementById('ratioD').innerText = `${gender}: ${percD}%`;
  document.getElementById('ratioP').innerText = `×‘×Ÿ ×–×•×’: ${100 - percD}%`;

  const calculatedFinal = Math.max(0, Math.floor((disp * ratioDVal) / 2));
  const manualVal = parseFloat(document.getElementById('manualAmt').value);
  
  const resFinal = document.getElementById('resFinal');
  const calcOrigArea = document.getElementById('calcOrigArea');
  const resCalcOrig = document.getElementById('resCalcOrig');

  if (!isNaN(manualVal) && document.getElementById('manualArea').style.display !== 'none') {
    resFinal.innerText = fmt(manualVal);
    calcOrigArea.style.display = 'block';
    resCalcOrig.innerText = `×—×•×©×‘ ××•×˜×•××˜×™×ª: ${fmt(calculatedFinal)}`;
  } else {
    resFinal.innerText = fmt(calculatedFinal);
    calcOrigArea.style.display = 'none';
  }

  document.getElementById('resInc').innerText = fmt(totalInc);
  document.getElementById('resLiv').innerText = fmt(livingTotal);
  document.getElementById('resDisp').innerText = disp > 0 ? fmt(disp) : 'â‚ª 0';
}

calc();
</script>
</body>
</html>
