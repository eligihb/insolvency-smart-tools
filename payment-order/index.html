<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™× - ×’×¨×¡×” ××”×•×“×§×ª</title>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root{
  --primary:#005f73; --secondary:#0a9396; --bg:#f4f7f9;
  --text:#1e293b; --label:#475569; --border:#cbd5e1;
  --danger:#be123c; --muted:#94a3b8;
}
*{box-sizing:border-box; font-family:'Heebo', sans-serif;}
body{background:var(--bg); color:var(--text); margin:0; padding:10px; display:flex; justify-content:center;}

/* ×’×•×“×œ ×”××—×©×‘×•×Ÿ - ××¦×•××¦× ×•××”×•×“×§ */
.calculator{ width:100%; max-width:820px; background:#fff; border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,0.1); overflow:hidden; }

header{ background:var(--primary); color:#fff; padding:10px; text-align:center; font-size:1.1rem; }

.board{ display: grid; grid-template-columns: 1.1fr 0.9fr; }

.col-in{ padding:15px; border-inline-end: 1px solid #eee; }
.col-out{ padding:15px; background:#f8fafc; }

.section-title{ 
    font-size:0.9rem; font-weight:700; color:var(--primary); 
    border-bottom:2px solid #e2e8f0; margin:10px 0; padding-bottom:3px;
}

.input-row{ display:flex; gap:10px; margin-bottom:10px; align-items:flex-end; }
.input-group{ display:flex; flex-direction:column; flex:1; }
.input-group label{ font-size:0.8rem; font-weight:600; color:var(--label); margin-bottom:3px; display:flex; align-items:center; gap:4px; }

input, select, textarea { 
    border:1px solid var(--border); padding:6px; border-radius:6px; font-size:0.9rem; width:100%; 
}
/* ×”×’×‘×œ×ª ×¨×•×—×‘ ×©×“×•×ª ×¡×›×•× */
input[type="number"] { max-width: 110px; }

.note-box{ font-size:0.75rem; height:35px; border:1px dashed #ccc; background:#fffdf5; margin-top:3px; resize:none; }

.chip{ 
    padding:5px 10px; border:1px solid var(--border); border-radius:6px; background:#fff; 
    font-size:0.8rem; cursor:pointer; flex:1; text-align:center;
}
.chip.active{ background:var(--secondary); color:#fff; }

/* ×ª×•×¦××•×ª */
.card{ background:#fff; border:1px solid #e2e8f0; border-radius:8px; padding:8px; text-align:center; margin-bottom:8px; }
.card .k{ color:var(--muted); font-size:0.75rem; }
.card .v{ font-weight:700; color:var(--primary); font-size:1rem; }

.ratio-bar{ height:8px; border-radius:4px; background:#e2e8f0; overflow:hidden; display:flex; margin:8px 0; }
.bar-d{ background:var(--primary); transition:0.3s; }
.bar-p{ background:var(--secondary); transition:0.3s; }

.final-card{ background:var(--primary); color:#fff; padding:12px; }
.final-v{ font-size:1.4rem; display:block; font-weight:800; }
.orig-val{ font-size:0.75rem; color:rgba(255,255,255,0.6); text-decoration:line-through; }

.info-q{ cursor:help; background:#e2e8f0; color:#666; width:14px; height:14px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-size:0.65rem; }

@media (max-width:750px){ .board{grid-template-columns:1fr;} }
</style>
</head>
<body>

<div class="calculator">
    <header>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™× (××¢×•×“×›×Ÿ 2026)</header>
    
    <div class="board">
        <div class="col-in">
            <div class="section-title">× ×ª×•× ×™ ×™×¡×•×“</div>
            <div class="input-row">
                <div class="input-group">
                    <label>×¡×˜×˜×•×¡</label>
                    <select id="familyType" onchange="calc()">
                        <option value="×™×—×™×“">×™×—×™×“</option>
                        <option value="×¨×•×•×§_×™×œ×“">×¨×•×•×§/×’×¨×•×©+×™×œ×“</option>
                        <option value="×–×•×’">×–×•×’</option>
                    </select>
                </div>
                <div class="input-group" style="max-width:100px">
                    <label>×™×œ×“×™×</label>
                    <div style="display:flex; gap:2px">
                        <button onclick="changeKids(-1)" style="padding:2px 8px">-</button>
                        <input id="kidsCount" type="number" value="0" readonly style="text-align:center; padding:2px">
                        <button onclick="changeKids(1)" style="padding:2px 8px">+</button>
                    </div>
                </div>
            </div>

            <div class="section-title">×”×›× ×¡×•×ª × ×˜×•</div>
            <div class="input-row">
                <div class="input-group">
                    <label id="lblSalD">×©×›×¨ (×—×™×™×‘) <span class="info-q" title="× ×˜×• ×œ××—×¨ × ×™×›×•×™×™ ×—×•×‘×”">?</span></label>
                    <input id="salD" type="number" oninput="calc()">
                </div>
                <div class="input-group">
                    <label id="lblSalP">×©×›×¨ (×‘×Ÿ ×–×•×’)</label>
                    <input id="salP" type="number" oninput="calc()">
                </div>
            </div>
            
            <div class="input-group">
                <label>×”×›× ×¡×•×ª × ×•×¡×¤×•×ª <span class="info-q" title="×©×›×™×¨×•×ª, ×¢×¡×§, ×‘×•× ×•×¡×™×">?</span></label>
                <input id="otherInc" type="number" oninput="calc()">
                <textarea class="note-box" id="otherNote" placeholder="×¤×™×¨×•×˜ ×”×›× ×¡×” × ×•×¡×¤×ª..."></textarea>
            </div>

            <div class="section-title">×§×¦×‘××•×ª ×•×”×¤×—×ª×•×ª</div>
            <button class="chip" style="width:100%; margin-bottom:8px" onclick="toggleSec('allowBox')">ğŸ¦ ×¤×™×¨×•×˜ ×§×¦×‘××•×ª</button>
            <div id="allowBox" style="display:none; background:#f9f9f9; padding:8px; border-radius:8px; margin-bottom:10px">
                <div id="allowList"></div>
                <button onclick="addAllow()" style="font-size:0.7rem">+ ×”×•×¡×£ ×§×¦×‘×”</button>
            </div>

            <div class="input-row">
                <button class="chip" id="btnJoint" onclick="toggleJoint()">×‘×Ÿ ×–×•×’ ×‘×”×œ×™×š</button>
                <button class="chip" onclick="toggleSec('specBox')">×”×•×¦××•×ª ××™×•×—×“×•×ª</button>
            </div>

            <div id="jointBox" style="display:none; margin-top:5px">
                <div class="input-group">
                    <label>×ª×™×§ ×¨××©×•×Ÿ ×‘×–××Ÿ (â‚ª)</label>
                    <input id="firstCase" type="number" oninput="calc()">
                </div>
            </div>

            <div id="specBox" style="display:none; background:#fff5f5; padding:8px; border-radius:8px; margin-top:5px">
                <div class="input-row">
                    <div class="input-group"><label>×¦×”×¨×•×Ÿ</label><input id="expChild" type="number" oninput="calc()"></div>
                    <div class="input-group"><label>×¨×¤×•××™</label><input id="expMed" type="number" oninput="calc()"></div>
                </div>
                <textarea class="note-box" id="specNote" placeholder="× ×™××•×§ ×”×•×¦××•×ª ××™×•×—×“×•×ª..."></textarea>
            </div>
        </div>

        <div class="col-out">
            <div class="section-title">×¡×™×›×•× ×”×—×™×©×•×‘</div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px">
                <div class="card"><div class="k">×¡×”"×› ×”×›× ×¡×•×ª</div><div class="v" id="resInc">â‚ª 0</div></div>
                <div class="card"><div class="k">×§×¦×‘×ª ×™×œ×“×™×</div><div class="v" id="resBtlKids">â‚ª 0</div></div>
                <div class="card"><div class="k">×“××™ ××—×™×™×”</div><div class="v" id="resLiv">â‚ª 0</div></div>
                <div class="card"><div class="k">×”×›× ×¡×” ×¤× ×•×™×”</div><div class="v" id="resDisp">â‚ª 0</div></div>
            </div>

            <div style="margin:10px 0">
                <div style="display:flex; justify-content:space-between; font-size:0.7rem; font-weight:700">
                    <span id="txtRatD">×—×™×™×‘: 0%</span> <span id="txtRatP">×‘×Ÿ ×–×•×’: 0%</span>
                </div>
                <div class="ratio-bar">
                    <div id="barD" class="bar-d" style="width:50%"></div>
                    <div id="barP" class="bar-p" style="width:50%"></div>
                </div>
            </div>

            <div class="card final-card">
                <div class="k" style="color:#eee">×¡×›×•× ×©× ×§×‘×¢ ×‘×¦×•</div>
                <span class="final-v" id="resFinal">â‚ª 0</span>
                <span class="orig-val" id="resOrig" style="display:none"></span>
                
                <div style="margin-top:10px; border-top:1px solid rgba(255,255,255,0.2); padding-top:8px">
                    <label style="font-size:0.7rem; display:block">×©×™× ×•×™ ×™×“× ×™ ×©×œ ×”×¡×›×•×:</label>
                    <input id="manualAmt" type="number" style="max-width:90px; color:#000; text-align:center" oninput="calc()">
                </div>
            </div>

            <div class="section-title">×”×¡×‘×¨ ×•× ×™××•×§×™×</div>
            <textarea id="finalNote" style="height:80px; font-size:0.8rem" placeholder="× ×™××•×§×™× ××©×¤×˜×™×™×..."></textarea>
            
            <button onclick="window.print()" style="width:100%; margin-top:10px; padding:8px; cursor:pointer">ğŸ–¨ï¸ ×”×“×¤×¡×ª ×“×•"×—</button>
        </div>
    </div>
</div>

<script>
const kidsMap = {0:0, 1:169, 2:383, 3:597, 4:811, 5:980, 6:1149, 7:1318, 8:1487, 9:1656, 10:1825};
const fmt = (n) => new Intl.NumberFormat('he-IL').format(Math.max(0, n || 0)) + ' â‚ª';

let isJoint = false;

function toggleSec(id) {
    const el = document.getElementById(id);
    el.style.display = el.style.display === 'none' ? 'block' : 'none';
}

function changeKids(v) {
    const i = document.getElementById('kidsCount');
    let val = parseInt(i.value) + v;
    if (val >= 0 && val <= 10) { i.value = val; calc(); }
}

function toggleJoint() {
    isJoint = !isJoint;
    document.getElementById('btnJoint').classList.toggle('active', isJoint);
    document.getElementById('jointBox').style.display = isJoint ? 'block' : 'none';
    calc();
}

function addAllow() {
    const div = document.createElement('div');
    div.style.display = "flex"; div.style.gap = "4px"; div.style.marginBottom = "4px";
    div.innerHTML = `<select style="flex:1"><option>× ×›×•×ª</option><option>×–×§× ×”</option><option>××‘×˜×œ×”</option><option>××—×¨</option></select>
                     <input type="number" style="width:80px" oninput="calc()" placeholder="â‚ª">
                     <button onclick="this.parentElement.remove();calc()">X</button>`;
    document.getElementById('allowList').appendChild(div);
}

function calc() {
    const sD = parseFloat(document.getElementById('salD').value) || 0;
    const sP = parseFloat(document.getElementById('salP').value) || 0;
    const oI = parseFloat(document.getElementById('otherInc').value) || 0;
    const kids = parseInt(document.getElementById('kidsCount').value) || 0;
    
    let totalAllow = 0;
    document.querySelectorAll('#allowList input').forEach(i => totalAllow += parseFloat(i.value) || 0);
    
    const btlKids = kidsMap[kids] || 0;
    const totalInc = sD + sP + oI + totalAllow + btlKids;
    
    const fType = document.getElementById('familyType').value;
    const livingBase = fType === '×™×—×™×“' ? 4556 : (fType === '×–×•×’' ? 6024 : 6056);
    const livingTotal = livingBase + (kids <= 4 ? kids * 1500 : (4 * 1500 + (kids - 4) * 1300));
    
    const eC = parseFloat(document.getElementById('expChild').value) || 0;
    const eM = parseFloat(document.getElementById('expMed').value) || 0;
    
    let disp = totalInc - livingTotal - eC - eM;
    if (isJoint) disp -= (parseFloat(document.getElementById('firstCase').value) || 0);

    const ratioD = totalInc > 0 ? (sD + oI/2 + totalAllow/2) / totalInc : 0;
    const percD = Math.round(ratioD * 100);
    
    document.getElementById('barD').style.width = percD + '%';
    document.getElementById('barP').style.width = (100 - percD) + '%';
    document.getElementById('txtRatD').innerText = `×—×™×™×‘: ${percD}%`;
    document.getElementById('txtRatP').innerText = `×‘×Ÿ ×–×•×’: ${100 - percD}%`;

    const calcFinal = Math.max(0, Math.floor((disp * ratioD) / 2));
    const manualAmt = parseFloat(document.getElementById('manualAmt').value);
    
    if (!isNaN(manualAmt) && manualAmt >= 0) {
        document.getElementById('resFinal').innerText = fmt(manualAmt);
        document.getElementById('resOrig').style.display = 'block';
        document.getElementById('resOrig').innerText = `×—×™×©×•×‘ ××§×•×¨×™: ${fmt(calcFinal)}`;
    } else {
        document.getElementById('resFinal').innerText = fmt(calcFinal);
        document.getElementById('resOrig').style.display = 'none';
    }

    document.getElementById('resInc').innerText = fmt(totalInc);
    document.getElementById('resBtlKids').innerText = fmt(btlKids);
    document.getElementById('resLiv').innerText = fmt(livingTotal);
    document.getElementById('resDisp').innerText = disp > 0 ? fmt(disp) : 'â‚ª 0';
}
calc();
</script>
</body>
</html>
