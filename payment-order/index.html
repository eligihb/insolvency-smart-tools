<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™×</title>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root{
  --primary:#005f73; --secondary:#0a9396; --bg:#f4f7f9;
  --text:#1e293b; --label:#475569; --border:#dbe3ea;
  --danger:#be123c; --muted:#94a3b8; --accent:#ee9b00;
}
*{box-sizing:border-box; font-family:'Heebo', sans-serif;}
body{background:var(--bg); color:var(--text); margin:0; padding:15px; display:flex; justify-content:center;}

/* ×’×•×“×œ ×§×•××¤×§×˜×™ - ×›-40% ××ª×¦×•×’×” ×¨×’×™×œ×” */
.calculator{ width:100%; max-width:820px; background:#fff; border-radius:15px; border:1px solid #eef2f6; overflow:hidden; display:flex; flex-direction:column;}

.board{ display: grid; grid-template-columns: 0.9fr 1.1fr; } /* ×ª×•×¦××•×ª ××©×××œ, ×”×–× ×” ××™××™×Ÿ */

/* ×¢××•×“×ª ×”×–× ×” (×™××™×Ÿ) */
.col-in{ padding:15px; border-inline-start: 1px solid #f0f0f0; order: 2; }
/* ×¢××•×“×ª ×ª×•×¦××•×ª (×©×××œ) */
.col-out{ padding:15px; background:#f8fbfe; order: 1; }

.section-title{ 
    font-size:0.95rem; font-weight:700; color:var(--primary); text-align:center;
    margin-bottom:12px; border-bottom:1px solid #eee; padding-bottom:5px;
}

.input-row{ display:flex; gap:8px; margin-bottom:10px; align-items:flex-end; }
.input-group{ display:flex; flex-direction:column; flex:1; position:relative;}
.input-group label{ font-size:0.8rem; font-weight:600; color:var(--label); margin-bottom:3px; display:flex; align-items:center; gap:3px; }

input, select, textarea { 
    border:1px solid var(--border); padding:6px 8px; border-radius:8px; font-size:0.9rem; width:100%; outline:none;
}
input[type="number"] { max-width: 130px; } /* ×”×’×‘×œ×” ×œ-7 ×¡×¤×¨×•×ª ×‘×¢×¨×š */

.chip-line{ display:flex; gap:5px; margin-bottom:10px; justify-content:center; flex-wrap:nowrap;}
.chip{ 
    padding:5px 12px; border:1px solid var(--border); border-radius:20px; background:#fff; 
    font-size:0.8rem; cursor:pointer; flex:1; text-align:center; white-space:nowrap;
}
.chip.active{ background:var(--secondary); color:#fff; border-color:var(--secondary); }
.chip.alert.active{ background:var(--danger); border-color:var(--danger); }

/* ×ª×•×¦××•×ª (×›×¨×˜×™×¡×™×•×ª ×œ×‘× ×•×ª) */
.result-grid{ display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.card{ background:#fff; border:1px solid #eef2f6; border-radius:10px; padding:8px; text-align:center; box-shadow:0 2px 4px rgba(0,0,0,0.02); }
.card .k{ color:var(--muted); font-size:0.75rem; font-weight:500; margin-bottom:2px;}
.card .v{ font-weight:700; color:var(--accent); font-size:1.05rem; }

.wide-card{ grid-column: 1 / -1; }
.final-val{ color:var(--primary) !important; font-size:1.3rem !important; }
.orig-gray{ font-size:0.75rem; color:#94a3b8; text-decoration:line-through; margin-top:3px; }

.info-q{ cursor:help; background:#eef6f6; color:var(--primary); width:15px; height:15px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-size:0.65rem; border:1px solid #d4e7e7;}

.btn-row{ display:flex; gap:5px; margin-bottom:15px; justify-content:center;}
.btn-top{ padding:5px 12px; border:1px solid #cfd8e3; border-radius:8px; background:#fff; font-size:0.8rem; cursor:pointer; display:flex; align-items:center; gap:4px;}

@media (max-width:750px){ .board{grid-template-columns:1fr;} .col-in{order:1} .col-out{order:2} }
</style>
</head>
<body>

<div class="calculator">
    <div class="board">
        <div class="col-out">
            <div class="btn-row">
                <button class="btn-top">××™×¤×•×¡ â†º</button>
                <button class="btn-top">×©×œ×™×—×ª ××™×™×œ âœ‰ï¸</button>
                <button class="btn-top">×¦×™×œ×•× ğŸ“¸</button>
                <button class="btn-top">PDF ğŸ–¨ï¸</button>
            </div>
            
            <div class="section-title">×ª×•×¦××•×ª ×”×—×™×©×•×‘</div>
            
            <div class="result-grid">
                <div class="card"><div class="k">×¡×š ×”×›× ×¡×•×ª</div><div class="v" id="resInc">â‚ª 0</div></div>
                <div class="card"><div class="k">×§×¦×‘×ª ×™×œ×“×™×</div><div class="v" id="resBtlKids">â‚ª 0</div></div>
                <div class="card"><div class="k">×¡×š ×”×•×¦××•×ª</div><div class="v" id="resExp">â‚ª 0</div></div>
                <div class="card"><div class="k">×“××™ ××—×™×™×”</div><div class="v" id="resLiv">â‚ª 6,024</div></div>
                
                <div class="card wide-card">
                    <div class="k">×”×›× ×¡×” ×¤× ×•×™×” ×œ×ª× ×”××©×¤×—×ª×™</div>
                    <div class="v" id="resDisp" style="color:var(--blue)">â‚ª 0</div>
                </div>

                <div class="card"><div class="k" id="ratLblD">××—×•×– ×”×›× ×¡×” (×—×™×™×‘)</div><div class="v" id="resRatD" style="color:var(--accent)">50.0%</div></div>
                <div class="card"><div class="k" id="ratLblP">××—×•×– ×”×›× ×¡×” (×‘×Ÿ ×–×•×’)</div><div class="v" id="resRatP" style="color:var(--accent)">50.0%</div></div>
                
                <div class="card"><div class="k" id="payLblD">×ª×©×œ×•× ××•×¦×¢ (×—×™×™×‘)</div><div class="v" id="resPayD">â‚ª 0</div></div>
                <div class="card"><div class="k" id="payLblP">×ª×©×œ×•× ××•×¦×¢ (×‘×Ÿ ×–×•×’)</div><div class="v" id="resPayP">â‚ª 0</div></div>

                <div class="card wide-card" style="background:#f0f7f7">
                    <div class="k">×ª×©×œ×•× ×—×•×“×©×™ ×œ×ª× ××©×¤×—×ª×™</div>
                    <span class="v final-val" id="resFinal">â‚ª 0</span>
                    <div id="origArea" style="display:none"><span class="orig-gray" id="resOrig"></span></div>
                    
                    <div style="margin-top:8px; padding-top:5px; border-top:1px dashed #ccc">
                        <label style="font-size:0.7rem; color:var(--label)">×©×™× ×•×™ ×¡×›×•× ×™×“× ×™:</label>
                        <input id="manualAmt" type="number" style="max-width:90px; height:25px; text-align:center" oninput="calc()">
                    </div>
                </div>
            </div>

            <textarea id="finalNote" class="note-box" style="width:100%; margin-top:10px; height:60px; font-size:0.8rem" placeholder="×”×¡×‘×¨ ×•× ×™××•×§×™×..."></textarea>
        </div>

        <div class="col-in">
            <div class="input-row">
                <div class="input-group">
                    <select id="familyType" onchange="calc()">
                        <option value="×–×•×’">×–×•×’</option>
                        <option value="×™×—×™×“">×™×—×™×“ / × ×©×•×™ ×—×™ ×‘× ×¤×¨×“</option>
                        <option value="×¨×•×•×§_×™×œ×“">×¨×•×•×§/×’×¨×•×©/××œ××Ÿ + ×™×œ×“</option>
                    </select>
                </div>
            </div>

            <div class="chip-line">
                <button class="chip active" id="btnM" onclick="setGen('×—×™×™×‘')">×—×™×™×‘</button>
                <button class="chip" id="btnF" onclick="setGen('×—×™×™×‘×ª')">×—×™×™×‘×ª</button>
                <button class="chip alert" id="btnJoint" onclick="toggleJoint()" style="flex:1.5">×©× ×™ ×‘× ×™ ×”×–×•×’ ×‘×”×œ×™×š?</button>
            </div>

            <div class="section-title" style="margin-top:5px">×”×›× ×¡×•×ª ×•×”×•×¦××•×ª ×”×ª× ×”××©×¤×—×ª×™ (â‚ª)</div>
            
            <div class="input-row">
                <div class="input-group">
                    <label id="lblSalD">×”×›× ×¡×” (×—×™×™×‘) <span class="info-q" title="×”×›× ×¡×” × ×˜×• ×œ××—×¨ × ×™×›×•×™×™ ×—×•×‘×”">?</span></label>
                    <input id="salD" type="number" oninput="calc()" placeholder="×”×–×Ÿ ×”×›× ×¡×”">
                </div>
                <div class="input-group">
                    <label id="lblSalP">×”×›× ×¡×” (×‘×Ÿ ×–×•×’) <span class="info-q" title="×”×›× ×¡×ª ×‘×Ÿ ×”×–×•×’ ×œ×—×™×©×•×‘ × ×˜×œ ××—×™×™×” ×™×—×¡×™">?</span></label>
                    <input id="salP" type="number" oninput="calc()" placeholder="×”×–×Ÿ ×”×›× ×¡×”">
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label id="lblOthD">×”×›× ×¡×•×ª ××—×¨×•×ª <span class="info-q" title="×©×›×™×¨×•×ª, ×‘×•× ×•×¡×™×, ×¢×¡×§">?</span></label>
                    <input id="othD" type="number" oninput="calc()" placeholder="×”×–×Ÿ ×”×›× ×¡×” ××—×¨×ª">
                </div>
                <div class="input-group">
                    <label>××¡×¤×¨ ×™×œ×“×™×</label>
                    <input id="kidsCount" type="number" value="0" min="0" max="10" oninput="calc()">
                </div>
            </div>

            <div class="chip-line">
                <button class="chip" onclick="toggleSec('allowBox')">×§×¦×‘××•×ª</button>
                <button class="chip" onclick="toggleSec('alimBox')">××–×•× ×•×ª</button>
            </div>

            <div id="allowBox" style="display:none; margin-bottom:10px">
                <div class="input-row">
                    <div class="input-group"><label id="lblAllD">×§×¦×‘×” (×—×™×™×‘)</label><input id="allD" type="number" oninput="calc()"></div>
                    <div class="input-group"><label id="lblAllP">×§×¦×‘×” (×‘×Ÿ ×–×•×’)</label><input id="allP" type="number" oninput="calc()"></div>
                </div>
            </div>

            <div id="alimBox" style="display:none; margin-bottom:10px">
                <div class="input-group"><label>×”×•×¦××•×ª ××–×•× ×•×ª</label><input id="expAlim" type="number" oninput="calc()"></div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label>×”×•×¦××•×ª ×˜×™×¤×•×œ ×•×¦×”×¨×•× ×™× <span class="info-q" title="×ª×§×¨×” ×œ×¦×”×¨×•×Ÿ: 1,000 â‚ª. ×˜×™×¤×•×œ ××ª×—×ª ×œ×’×™×œ ×—×•×‘×”: 2,500 â‚ª.">?</span></label>
                    <input id="expChild" type="number" oninput="calc()" placeholder="×”×–×Ÿ ×”×•×¦××•×ª">
                </div>
                <div class="input-group">
                    <label>×”×•×¦××•×ª ×—×¨×™×’×•×ª <span class="info-q" title="×˜×™×¤×•×œ×™× ×¨×¤×•××™×™× ×—×™×•× ×™×™× ×©××™× × ×‘×¡×œ ×”×‘×¨×™××•×ª">?</span></label>
                    <input id="expMed" type="number" oninput="calc()" placeholder="×”×–×Ÿ ×”×•×¦××•×ª">
                </div>
            </div>

            <div id="jointFirstBox" style="display:none; margin-top:5px; border:1px dashed var(--secondary); padding:8px; border-radius:8px">
                <div class="input-group">
                    <label>×¡×›×•× ×‘×ª×™×§ ×¨××©×•×Ÿ ×‘×–××Ÿ (â‚ª) <span class="info-q" title="×”×¡×›×•× ×©× ×§×‘×¢ ×œ×‘×Ÿ ×”×–×•×’ ×‘×ª×™×§ ×”××§×‘×™×œ">?</span></label>
                    <input id="firstCase" type="number" oninput="calc()">
                </div>
            </div>
        </div>
    </div>
</div>

<script>
const btlKidsMap = {0:0, 1:169, 2:383, 3:597, 4:811, 5:980, 6:1149, 7:1318, 8:1487, 9:1656, 10:1825};
const fmt = (n) => new Intl.NumberFormat('he-IL').format(Math.max(0, n || 0)) + ' â‚ª';

let gender = '×—×™×™×‘', isJoint = false;

function toggleSec(id) {
    const el = document.getElementById(id);
    el.style.display = el.style.display === 'none' ? 'block' : 'none';
}

function toggleJoint() {
    isJoint = !isJoint;
    document.getElementById('btnJoint').classList.toggle('active', isJoint);
    document.getElementById('jointFirstBox').style.display = isJoint ? 'block' : 'none';
    calc();
}

function setGen(g) {
    gender = g;
    document.getElementById('btnM').classList.toggle('active', g === '×—×™×™×‘');
    document.getElementById('btnF').classList.toggle('active', g === '×—×™×™×‘×ª');
    const p = (g === '×—×™×™×‘') ? '×‘×ª ×–×•×’' : '×‘×Ÿ ×–×•×’';
    
    document.getElementById('lblSalD').childNodes[0].textContent = `×”×›× ×¡×” (${g}) `;
    document.getElementById('lblSalP').childNodes[0].textContent = `×”×›× ×¡×” (${p}) `;
    document.getElementById('lblAllD').innerText = `×§×¦×‘×” (${g})`;
    document.getElementById('lblAllP').innerText = `×§×¦×‘×” (${p})`;
    document.getElementById('ratLblD').innerText = `××—×•×– ×”×›× ×¡×” (${g})`;
    document.getElementById('ratLblP').innerText = `××—×•×– ×”×›× ×¡×” (${p})`;
    document.getElementById('payLblD').innerText = `×ª×©×œ×•× ××•×¦×¢ (${g})`;
    document.getElementById('payLblP').innerText = `×ª×©×œ×•× ××•×¦×¢ (${p})`;
    calc();
}

function calc() {
    // ×§×œ×˜ ×‘×¡×™×¡×™
    const sD = parseFloat(document.getElementById('salD').value) || 0;
    const sP = parseFloat(document.getElementById('salP').value) || 0;
    const oD = parseFloat(document.getElementById('othD').value) || 0;
    const aD = parseFloat(document.getElementById('allD').value) || 0;
    const aP = parseFloat(document.getElementById('allP').value) || 0;
    const kids = parseInt(document.getElementById('kidsCount').value) || 0;
    
    // ×”×›× ×¡×•×ª [cite: 160, 161]
    const btlKids = btlKidsMap[kids] || 0;
    const totalInc = sD + sP + oD + aD + aP + btlKids;
    
    // ×“××™ ××—×™×™×” (Living Cost) [cite: 239, 123]
    const fType = document.getElementById('familyType').value;
    const livingBase = fType === '×™×—×™×“' ? 4556 : (fType === '×–×•×’' ? 6024 : 6056);
    const livingTotal = livingBase + (kids <= 4 ? kids * 1500 : (4 * 1500 + (kids - 4) * 1300));
    
    // ×”×•×¦××•×ª ××™×•×—×“×•×ª [cite: 118, 174, 175]
    const eC = parseFloat(document.getElementById('expChild').value) || 0;
    const eM = parseFloat(document.getElementById('expMed').value) || 0;
    const eA = parseFloat(document.getElementById('expAlim').value) || 0;
    const totalExp = eC + eM + eA;

    // ×”×›× ×¡×” ×¤× ×•×™×” [cite: 98, 118]
    let disp = totalInc - livingTotal - totalExp;
    if (isJoint) disp -= (parseFloat(document.getElementById('firstCase').value) || 0);

    // ×™×—×¡×™× [cite: 183, 184]
    const debtorPart = sD + oD + aD;
    const ratioD = totalInc > 0 ? (debtorPart / totalInc) : 0;
    
    // ×ª×©×œ×•× ××•×¦×¢ (××—×¦×™×ª ××”×¤× ×•×™×” ×”×™×—×¡×™×ª) [cite: 126, 127]
    const calcPayD = Math.max(0, Math.floor((disp * ratioD) / 2));
    const calcPayP = Math.max(0, Math.floor((disp * (1 - ratioD)) / 2));

    // ×¢×“×›×•×Ÿ ×ª×¦×•×’×”
    document.getElementById('resInc').innerText = fmt(totalInc);
    document.getElementById('resBtlKids').innerText = fmt(btlKids);
    document.getElementById('resLiv').innerText = fmt(livingTotal);
    document.getElementById('resExp').innerText = fmt(totalExp);
    document.getElementById('resDisp').innerText = disp > 0 ? fmt(disp) : 'â‚ª 0';
    document.getElementById('resRatD').innerText = (ratioD * 100).toFixed(1) + '%';
    document.getElementById('resRatP').innerText = ((1 - ratioD) * 100).toFixed(1) + '%';
    document.getElementById('resPayD').innerText = fmt(calcPayD);
    document.getElementById('resPayP').innerText = fmt(calcPayP);

    // ×¡×›×•× ×¡×•×¤×™ ×•×©×™× ×•×™ ×™×“× ×™
    const manualAmt = parseFloat(document.getElementById('manualAmt').value);
    const finalAuto = isJoint ? (calcPayD + calcPayP) : calcPayD;
    
    if (!isNaN(manualAmt) && manualAmt >= 0) {
        document.getElementById('resFinal').innerText = fmt(manualAmt);
        document.getElementById('origArea').style.display = 'block';
        document.getElementById('resOrig').innerText = `×—×™×©×•×‘ ××§×•×¨×™: ${fmt(finalAuto)}`;
    } else {
        document.getElementById('resFinal').innerText = fmt(finalAuto);
        document.getElementById('origArea').style.display = 'none';
    }
}
calc();
</script>
</body>
</html>
