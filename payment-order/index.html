<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™× - YE Professional 2026</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <style>
    :root {
      --primary: #1e293b; --secondary: #0f172a; --inner-bg: #1e293b;
      --panel: #334155; --text: #ffffff; --label: #cbd5e1;
      --border: #475569; --accent: #38bdf8; --danger: #fb7185; --success: #34d399;
    }

    * { box-sizing: border-box; }
    body {
      font-family: 'Heebo', sans-serif; background: #ffffff;
      margin: 0; padding: 0; display: flex; justify-content: center; align-items: flex-start;
      min-height: 100vh; overflow-x: hidden;
    }

    .main-container {
      width: 1100px; background: var(--inner-bg); padding: 20px 30px;
      border-radius: 20px; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4);
      margin: 20px auto; position: relative;
      transform: scale(0.62); transform-origin: top center;
    }

    .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .date-tag {
      background: rgba(56, 189, 248, 0.15); color: var(--accent);
      padding: 5px 15px; border-radius: 8px; font-weight: 700;
      border: 1px solid var(--accent); font-size: 0.9rem;
    }

    .top-controls { display: flex; gap: 6px; }
    .btn-ctrl {
      background: var(--panel); border: 1px solid var(--border); color: #fff;
      padding: 6px 12px; border-radius: 8px; font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: 0.2s;
    }
    .btn-ctrl:hover { border-color: var(--accent); background: var(--secondary); }

    /* ×›×¤×ª×•×¨ ×”×“×’××” ×™×•×§×¨×ª×™ */
    .demo-btn { background: linear-gradient(135deg, #0ea5e9, #38bdf8); color: #000; border: none; font-weight: 800; }

    header { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 12px; margin-bottom: 15px; border: 1px solid var(--border); }
    header h1 { margin: 0; font-size: 1.5rem; font-weight: 700; color: #fff; text-align: center; }

    .board { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; }
    .inputs-col, .results-col { background: var(--panel); border: 1px solid var(--border); border-radius: 18px; padding: 20px; }

    .section-title {
      display: flex; align-items: center; justify-content: center; margin-bottom: 12px; color: #fff;
      font-size: 1.1rem; font-weight: 700; border-bottom: 1px solid var(--border); padding-bottom: 6px;
    }

    .info-trigger {
      display: inline-block; width: 18px; height: 18px; background: var(--accent); color: var(--secondary);
      border-radius: 50%; font-size: 12px; line-height: 18px; text-align: center; font-weight: bold;
      margin-right: 6px; cursor: help; position: relative;
    }
    .info-trigger:hover::after {
      content: attr(data-tip); position: absolute; bottom: 130%; right: 0;
      background: #000; color: #fff; padding: 12px; border-radius: 10px;
      font-size: 0.85rem; width: 280px; z-index: 1000; text-align: right; line-height: 1.5;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8); border: 1px solid var(--accent);
    }

    .input-group { display: flex; flex-direction: column; margin-bottom: 10px; align-items: center; width: 100%; }
    .input-group label { font-size: 0.95rem; font-weight: 600; color: var(--label); margin-bottom: 6px; text-align: center; width: 100%; }

    input, select, textarea {
      padding: 10px; border: 1.5px solid var(--border); border-radius: 12px;
      background: var(--secondary); color: #ffffff !important; font-size: 1.1rem; font-weight: 600;
      text-align: center; width: 100%;
    }
    .amt-input { color: var(--accent) !important; font-size: 1.25rem; width: 160px !important; }

    .chip {
      padding: 10px; border: 1.5px solid var(--border); border-radius: 12px;
      background: var(--secondary); cursor: pointer; color: #fff; font-weight: 600; font-size: 0.95rem;
      flex: 1; min-height: 52px; display: flex; align-items: center; justify-content: center;
    }
    .chip.active { background: var(--accent); color: var(--secondary); border-color: var(--accent); }

    .category-btn-group { display: flex; gap: 8px; margin: 20px 0; width: 100%; }

    .result-grid { display: grid; grid-template-columns: 1fr 1fr !important; gap: 15px; }
    .result-card { background: var(--secondary); border: 1px solid var(--border); border-radius: 18px; padding: 16px; text-align: center; position: relative; }
    .result-card .k { color: var(--label); font-size: 0.95rem; margin-bottom: 6px; }
    .result-card .v { font-size: 1.35rem; font-weight: 800; color: #ffffff !important; }

    .ratio-bar-container { width: 100%; height: 18px; background: #475569; border-radius: 9px; margin: 12px 0; overflow: hidden; display: flex; }
    .bar-d, .bar-p { height: 100%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; color: #fff !important; font-weight: 900; transition: 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    .bar-d { background: var(--accent); } .bar-p { background: var(--success); }

    .result-wide { grid-column: 1 / -1 !important; }
    .result-big .v { font-size: 1.8rem; color: var(--accent) !important; font-weight: 900; }

    .insight-box {
      width: 100%; background: rgba(56, 189, 248, 0.12); border-radius: 15px;
      padding: 20px; margin-top: 25px; border-right: 6px solid var(--accent);
      font-size: 0.95rem; line-height: 1.6; color: #ffffff !important; display: none;
    }
    .insight-item { display: flex; gap: 10px; margin-bottom: 10px; align-items: flex-start; }

    #entryPanel { position: relative; display: none; background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 15px; border: 1px dashed var(--accent); margin-top: 10px; }
    .close-x { position: absolute; top: 5px; left: 10px; color: var(--danger); cursor: pointer; font-weight: 800; font-size: 1.3rem; }

    /* ×¡×™×•×¨ ××•×“×¨×š - Coach Box */
    #demoCoach {
      position: fixed; bottom: 40px; left: 40px; background: #fff; color: #1e293b;
      padding: 20px; border-radius: 20px; width: 350px; box-shadow: 0 15px 50px rgba(0,0,0,0.5);
      z-index: 9999; display: none; border-right: 10px solid var(--accent); font-weight: 500;
    }
    .demo-highlight { animation: pulseHighlight 1.5s infinite; border-color: var(--accent) !important; }
    @keyframes pulseHighlight {
      0% { box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.7); }
      70% { box-shadow: 0 0 0 20px rgba(56, 189, 248, 0); }
      100% { box-shadow: 0 0 0 0 rgba(56, 189, 248, 0); }
    }

    footer { margin-top: 25px; text-align: center; border-top: 1px solid var(--border); padding-top: 15px; font-size: 1.1rem; color: var(--label); font-weight: 700; }

    @media print {
      body { background: #fff !important; }
      .main-container { transform: none !important; width: 100% !important; box-shadow: none !important; }
      .top-controls, #entryPanel, #manualBox, .category-btn-group { display: none !important; }
      .inputs-col, .results-col, .result-card { background: #fff !important; border: 2px solid #000 !important; color: #000 !important; }
      .v, .k, label, .section-title { color: #000 !important; }
    }
  </style>
</head>

<body>
  <div id="demoCoach"></div>

  <div class="main-container" id="calcRoot">
    <div class="top-bar">
      <div id="dateTag" class="date-tag">--/--/----</div>
      <div class="top-controls">
        <button class="btn-ctrl demo-btn" id="btnDemo" onclick="runSmartDemo()">×¡×™×•×¨ ××•×“×¨×š âœ¨</button>
        <button class="btn-ctrl" onclick="window.print()">×”×“×¤×¡×”/PDF ğŸ–¨ï¸</button>
        <button class="btn-ctrl" id="btnShot">×¦×™×œ×•× ğŸ“¸</button>
        <button class="btn-ctrl" onclick="restoreFromStorage()">×©×—×–×•×¨ × ×ª×•× ×™× â†º</button>
        <button class="btn-ctrl" style="color:var(--danger)" onclick="resetData()">××™×¤×•×¡ âœ–</button>
      </div>
    </div>

    <header><h1>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™× ××§×¦×•×¢×™</h1></header>

    <div class="board">
      <div class="inputs-col" id="stepInput">
        <div class="section-title">ğŸ‘¤ × ×ª×•× ×™ ×‘×¡×™×¡ ×•×”×›× ×¡×•×ª</div>
        <div class="input-group" id="demoFamily">
          <div style="display:flex; gap:8px; width:100%;">
            <button class="chip family-type active" data-type="×™×—×™×“">×™×—×™×“ (× ×©×•×™ ×—×™ ×‘× ×¤×¨×“)</button>
            <button class="chip family-type" data-type="×–×•×’">×–×•×’</button>
            <button class="chip family-type" data-type="×¨×•×•×§">×¨×•×•×§ / ×’×¨×•×© / ××œ××Ÿ</button>
          </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
          <div class="input-group" id="demoKids">
            <label><span class="info-trigger" data-tip="×›×•×œ×œ ×§×˜×™× ×™× ×¢×“ ×’×™×œ 18. × ×™×ª×Ÿ ×œ×›×œ×•×œ ×‘× ×™ 18-21 ×”××©×¨×ª×™× ×‘×©×™×¨×•×ª ×—×•×‘×”/×œ××•××™.">?</span> ×™×œ×“×™× (×¢×“ 18)</label>
            <div style="display: flex; gap: 8px; align-items: center;">
              <button class="chip" style="min-height:40px; color:var(--danger);" onclick="changeKids(-1)">-</button>
              <input id="childrenCount" type="number" value="0" min="0" oninput="calc()" style="width: 65px;">
              <button class="chip" style="min-height:40px;" onclick="changeKids(1)">+</button>
            </div>
          </div>
          <div class="input-group"><label>××™ ×‘×”×œ×™×š?</label>
            <div style="display:flex; gap:8px; width:100%;">
              <button class="chip gender-btn active" data-gender="×—×™×™×‘" onclick="setGender('×—×™×™×‘', this)">×—×™×™×‘</button>
              <button class="chip gender-btn" data-gender="×—×™×™×‘×ª" onclick="setGender('×—×™×™×‘×ª', this)">×—×™×™×‘×ª</button>
            </div>
          </div>
        </div>

        <hr style="border:0; border-top:1.5px solid var(--border); margin: 20px 0;">

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;" id="demoSalary">
          <div class="input-group"><label>×”×›× ×¡×” ×—×™×™×‘/×ª</label><input id="salD" type="text" class="amt-input live-curr" placeholder="0"></div>
          <div class="input-group"><label>×”×›× ×¡×” ×‘×Ÿ ×–×•×’</label><input id="salP" type="text" class="amt-input live-curr" placeholder="0"></div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
          <div class="input-group"><label>×”×›× ×¡×” × ×•×¡×¤×ª (×—×™×™×‘)</label><input id="addD" type="text" class="amt-input live-curr" placeholder="0"></div>
          <div class="input-group"><label>×”×›× ×¡×” × ×•×¡×¤×ª (×‘×Ÿ ×–×•×’)</label><input id="addP" type="text" class="amt-input live-curr" placeholder="0"></div>
        </div>

        <div class="section-title" style="margin-top:20px;">â• ×ª×•×¡×¤×•×ª ×•×”×•×¦××•×ª</div>
        <div id="incomeAdditions" style="margin-top:10px;"></div>
        <div id="expenseAdditions"></div>

        <div class="category-btn-group" id="demoButtons">
          <button class="chip" onclick="toggleEntry('allowance')">×§×¦×‘××•×ª â•</button>
          <button class="chip" onclick="toggleEntry('special')">×”×•×¦××•×ª â•</button>
          <button class="chip" onclick="toggleEntry('alimony')">××–×•× ×•×ª â•</button>
        </div>

        <div id="entryPanel">
          <span class="close-x" onclick="closeEntry()">âœ–</span>
          <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 10px; margin-bottom: 10px;">
            <select id="entryType"></select>
            <input id="entryAmt" type="text" class="live-curr" placeholder="â‚ª">
          </div>
          <input id="entryNote" type="text" placeholder="×”×¢×¨×” / ×¤×™×¨×•×˜">
          <div style="display:flex; justify-content:center; margin-top:10px;"><span style="cursor:pointer; font-weight:700; color:var(--success); font-size:1.1rem;" onclick="commitEntry()">âœ… ×¢×“×›×Ÿ</span></div>
        </div>
      </div>

      <div class="results-col" id="stepResult">
        <div class="section-title">ğŸ“Š ×¡×™×›×•× ×—×™×©×•×‘</div>
        <div class="result-grid">
          <div class="result-card"><div class="k">×¡×”×´×› ×”×›× ×¡×•×ª</div><div id="resIncome" class="v">0 â‚ª</div></div>
          <div class="result-card"><div class="k">×§×¦×‘×ª ×™×œ×“×™×</div><div id="resKidsSS" class="v">0 â‚ª</div></div>
          <div class="result-card"><div class="k">×“××™ ××—×™×™×”</div><div id="resBase" class="v">0 â‚ª</div></div>
          <div class="result-card"><div class="k">×¡×”×´×› ×”×•×¦××•×ª</div><div id="resExp" class="v">0 â‚ª</div></div>
          <div class="result-card result-wide result-big" id="demoDisp"><div class="k">×”×›× ×¡×” ×¤× ×•×™×”</div><div id="resDisp" class="v">××™×Ÿ ×¤× ×•×™×”</div></div>
          <div class="result-card result-wide">
            <div class="k">×™×—×¡ ×”×›× ×¡×•×ª ×—×œ×•×§×ª × ×˜×œ</div>
            <div class="ratio-bar-container"><div id="barD" class="bar-d"></div><div id="barP" class="bar-p"></div></div>
            <div style="display:flex; justify-content:space-between; font-size:0.9rem; font-weight:700;">
              <span id="resRatioD">×—×™×™×‘: 0%</span><span id="resRatioP">×‘×Ÿ ×–×•×’: 0%</span>
            </div>
          </div>
          <div class="result-card result-wide result-big" style="border: 2px solid var(--accent);">
            <button class="btn-manual-top" onclick="toggleManual()">×©× ×” ×¡×›×•×</button>
            <div class="k">×ª×©×œ×•× ×—×•×“×©×™ ××•×¦×¢</div>
            <div id="resFinalPay" class="v" style="color: var(--danger) !important">0 â‚ª</div>
          </div>
        </div>
      </div>
    </div>

    <div id="insightBox" class="insight-box"></div>
    <footer>YE - ×¤×ª×¨×•× ×•×ª ×—×›××™× ×œ× ×™×”×•×œ ×”×œ×™×›×™ ×—×“×œ×•×ª ×¤×™×¨×¢×•×Ÿ &copy; 2026</footer>
  </div>

  <script>
    const E = id => document.getElementById(id);
    const parseVal = s => parseInt(String(s || '').replace(/[^\d]/g, '')) || 0;
    const formatVal = n => new Intl.NumberFormat('he-IL').format(n) + (n > 0 ? ' â‚ª' : '');
    const STORAGE_KEY = 'ye_payment_calc_2026_final_sync';

    let isRestoring = false;
    let state = { incomes: [], expenses: [], currentMode: '', gender: '×—×™×™×‘', family: '×™×—×™×“', isManual: false };
    const config = { 
        base: { "×™×—×™×“": 4711, "×¨×•×•×§": 4711, "×–×•×’": 6229 }, 
        kidsSS: { 0: 0, 1: 173, 2: 392, 3: 611, 4: 830, 5: 1003 } 
    };

    function applyLiveFormatting(el) { el.addEventListener('input', e => { if (isRestoring) return; e.target.value = parseVal(e.target.value) > 0 ? formatVal(parseVal(e.target.value)) : ''; calc(); }); }
    document.querySelectorAll('.live-curr').forEach(applyLiveFormatting);
    window.onload = () => { E('dateTag').textContent = new Date().toLocaleDateString('he-IL'); calc(); };

    function changeKids(n) { E('childrenCount').value = Math.max(0, parseInt(E('childrenCount').value) + n); calc(); }
    function setGender(g, btn) { state.gender = g; document.querySelectorAll('.gender-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); calc(); }
    document.querySelectorAll('.family-type').forEach(btn => { btn.onclick = () => { document.querySelectorAll('.family-type').forEach(b => b.classList.remove('active')); btn.classList.add('active'); state.family = btn.dataset.type; calc(); }; });

    function toggleEntry(mode) { if (state.currentMode === mode && E('entryPanel').style.display === 'block') { closeEntry(); } else { openEntry(mode); } }
    function openEntry(mode) {
      state.currentMode = mode; E('entryPanel').style.display = 'block'; const s = E('entryType'); s.innerHTML = '';
      if (mode === 'allowance') ['× ×›×•×ª', '×–×§× ×”', '×”×‘×˜×—×ª ×”×›× ×¡×”', '××—×¨'].forEach(o => s.add(new Option(o, o)));
      else if (mode === 'special') ['×—×¨×™×’×•×ª', '×¦×”×¨×•×Ÿ', '×ª×©×œ×•× ×‘×Ÿ ×–×•×’', '××—×¨'].forEach(o => s.add(new Option(o, o)));
      else s.add(new Option('××–×•× ×•×ª', '××–×•× ×•×ª'));
    }

    function commitEntry() {
      const amt = parseVal(E('entryAmt').value); let type = E('entryType').value; let note = E('entryNote').value;
      if (type.includes('×‘×Ÿ ×–×•×’')) note = "×ª×™×§ ×¨××©×•×Ÿ ×‘×–××Ÿ";
      if (amt > 0) { state[state.currentMode === 'allowance' ? 'incomes' : 'expenses'].push({ type, amt, note }); renderLists(); closeEntry(); calc(); }
    }
    function closeEntry() { E('entryPanel').style.display = 'none'; state.currentMode = ''; E('entryAmt').value = ''; E('entryNote').value = ''; }

    function renderLists() {
      const row = (item, i, list) => `<div style="display:grid; grid-template-columns: 1fr 0.8fr 1.4fr 25px; background:var(--secondary); padding:8px 12px; border-radius:10px; margin-bottom:5px; font-size:0.9rem; align-items:center; border-right:4px solid var(--accent); color:#fff !important;"><span>${item.type}</span><span style="font-weight:700">${formatVal(item.amt)}</span><span>${item.note}</span><span style="color:var(--danger); cursor:pointer;" onclick="removeItem('${list}', ${i})">âœ–</span></div>`;
      E('incomeAdditions').innerHTML = state.incomes.map((item, i) => row(item, i, 'incomes')).join('');
      E('expenseAdditions').innerHTML = state.expenses.map((item, i) => row(item, i, 'expenses')).join('');
    }

    function removeItem(list, i) { state[list].splice(i, 1); renderLists(); calc(); }
    function toggleManual() { const a = prompt("×”×–×Ÿ ×¡×›×•×:"); if(a) { state.isManual=true; state.manualAmt=a; calc(); } }
    function resetManual() { state.isManual = false; calc(); }

    function calc() {
      const kCount = parseInt(E('childrenCount').value || 0);
      const kidsAddition = kCount <= 4 ? kCount * 1500 : (4 * 1500) + ((kCount - 4) * 1300);
      const baseP = (config.base[state.family] || 4711) + kidsAddition;
      const kSS = kCount <= 5 ? config.kidsSS[kCount] : 1003 + (kCount - 5) * 173;
      const dSal = parseVal(E('salD').value) + parseVal(E('addD').value), pSal = parseVal(E('salP').value) + parseVal(E('addP').value);
      const allowT = state.incomes.reduce((s, a) => s + a.amt, 0), spouseP = state.expenses.filter(e => e.type.includes('×‘×Ÿ ×–×•×’')).reduce((s, a) => s + a.amt, 0);
      const totalI = dSal + pSal + allowT + kSS, totalE = baseP + state.expenses.reduce((s, a) => s + a.amt, 0), disp = totalI - totalE;

      E('resIncome').textContent = formatVal(totalI); E('resKidsSS').textContent = formatVal(kSS); E('resBase').textContent = formatVal(baseP); E('resExp').textContent = formatVal(totalE);
      const pD = Math.round((dSal / (dSal + pSal || 1)) * 100);
      E('barD').style.width = pD + "%"; E('barD').textContent = pD > 10 ? pD + "%" : ""; E('barP').style.width = (100 - pD) + "%"; E('barP').textContent = (100 - pD) > 10 ? (100 - pD) + "%" : "";
      E('resRatioD').textContent = `×—×™×™×‘: ${pD}%`; E('resRatioP').textContent = `×‘×Ÿ ×–×•×’: ${100 - pD}%`;

      const ins = E('insightBox'); ins.style.display = "block";
      let insights = [{ icon: "â„¹ï¸", text: `<b>×ª×•×‘× ×•×ª-</b> ×“××™ ×”××—×™×” ×”×‘×¡×™×¡×™×™× ×”××•×’× ×™× ×”× ${formatVal(baseP)}.` }];
      if (kCount >= 5) insights.push({ icon: "âš–ï¸", text: "××”×™×œ×“ ×”×—××™×©×™ ××—×•×©×‘×ª ×ª×•×¡×¤×ª ××•×¤×—×ª×ª ×©×œ 1,300 â‚ª." });
      
      if (disp <= 0) {
        E('resDisp').textContent = "××™×Ÿ ×”×›× ×¡×” ×¤× ×•×™×”"; E('resDisp').style.fontSize = "0.85rem";
        E('resFinalPay').textContent = (dSal === 0 && allowT > 0) ? "×ª×™×§ ××¤×¡" : "0 â‚ª";
      } else {
        E('resDisp').textContent = formatVal(disp); E('resDisp').style.fontSize = "1.5rem";
        const calcPay = Math.floor(((disp * (dSal / (dSal + pSal || 1))) / 2) / 10) * 10;
        E('resFinalPay').textContent = state.isManual ? formatVal(parseVal(state.manualAmt)) : formatVal(calcPay);
      }
      ins.innerHTML = insights.map(i => `<div class="insight-item"><span>${i.icon}</span><span>${i.text}</span></div>`).join('');
      if (!isRestoring) localStorage.setItem(STORAGE_KEY, JSON.stringify({ ...state, kids: E('childrenCount').value, salD: E('salD').value, salP: E('salP').value, addD: E('addD').value, addP: E('addP').value }));
    }

    function restoreFromStorage() {
      const raw = localStorage.getItem(STORAGE_KEY); if (!raw) return alert("××™×Ÿ × ×ª×•× ×™×.");
      isRestoring = true; const d = JSON.parse(raw);
      E('childrenCount').value = d.kids; E('salD').value = d.salD; E('salP').value = d.salP;
      E('addD').value = d.addD; E('addP').value = d.addP;
      state = { ...d }; renderLists();
      document.querySelectorAll('.family-type').forEach(b => b.classList.toggle('active', b.dataset.type === state.family));
      document.querySelectorAll('.gender-btn').forEach(b => b.classList.toggle('active', b.dataset.gender === state.gender));
      isRestoring = false; calc();
    }

    function resetData() { if(confirm("×œ××¤×¡?")) { localStorage.removeItem(STORAGE_KEY); location.reload(); } }
    E('btnShot').onclick = () => { html2canvas(E('calcRoot'), { scale: 2, backgroundColor: '#1e293b' }).then(c => { const a = document.createElement('a'); a.download = 'ye-calc.png'; a.href = c.toDataURL(); a.click(); }); };

    /* ××¢×¨×›×ª ×”×“×’××” ×—×›××” */
    async function runSmartDemo() {
        const coach = E('demoCoach');
        const speak = async (msg, time = 3500) => { coach.innerHTML = msg; coach.style.display = 'block'; await new Promise(r => setTimeout(r, time)); };
        const highlight = (id) => { document.querySelectorAll('.demo-highlight').forEach(el => el.classList.remove('demo-highlight')); if(id) E(id).classList.add('demo-highlight'); };

        await speak("×‘×¨×•×›×™× ×”×‘××™× ×œ×¡×™×•×¨ ×”××•×“×¨×š! ×‘×•××• × ×¨××” ××™×š ×”××—×©×‘×•×Ÿ ×× ×ª×— ××§×¨×” ××•×¨×›×‘ ×‘-2026.");
        highlight('demoFamily');
        await speak("× ×‘×—×¨ ×‘××¦×‘ ××©×¤×—×ª×™ ×©×œ '×–×•×’'. ×©×™× ×œ×‘ ××™×š ×‘×¡×™×¡ ×”××—×™×” ××©×ª× ×” ×œ-6,229 â‚ª.");
        document.querySelectorAll('.family-type')[1].click();
        
        highlight('demoKids');
        await speak("× ×’×“×™×¨ 5 ×™×œ×“×™×. ×”××—×©×‘×•×Ÿ ××—×©×‘ ××•×˜×•××˜×™×ª ×ª×•×¡×¤×ª ×©×œ 1,500 â‚ª ×œ×™×œ×“ ×¢×“ ×”×¨×‘×™×¢×™, ×•-1,300 â‚ª ××”×—××™×©×™.");
        E('childrenCount').value = 5; calc();

        highlight('demoSalary');
        await speak("× ×–×™×Ÿ ×”×›× ×¡×•×ª: ×—×™×™×‘ (12,500 â‚ª) ×•×‘×ª ×–×•×’ (9,000 â‚ª). ×”××—×©×‘×•×Ÿ ×™×—×©×‘ ××ª ×™×—×¡ ×—×œ×•×§×ª ×”× ×˜×œ ×”××“×•×™×§.");
        E('salD').value = "12,500 â‚ª"; E('salP').value = "9,000 â‚ª"; calc();

        highlight('demoButtons');
        await speak("× ×•×¡×™×£ '×§×¦×‘×ª × ×›×•×ª' ××•×’× ×ª. ×”××—×©×‘×•×Ÿ ××•×¡×™×£ ××•×ª×” ×œ×”×›× ×¡×•×ª, ××š ×‘×ª×™×‘×ª ×”×ª×•×‘× ×•×ª ×™×¡×‘×™×¨ ×©×”×™× ××•×’× ×ª ×•×œ× ×ª×™×œ×§×— ×œ×§×•×¤×”!");
        state.incomes.push({type: '× ×›×•×ª', amt: 4500, note: '××•×’× ×ª ×¢×œ ×¤×™ ×“×™×Ÿ'}); renderLists(); calc();

        highlight('stepResult');
        await speak("×‘×¡×•×£, ×”××—×©×‘×•×Ÿ ××¦×™×’ '×”×›× ×¡×” ×¤× ×•×™×”' ×××™×ª×™×ª ×•×§×•×‘×¢ ×¦×• ×ª×©×œ×•××™× ×©××©×§×œ×œ ×”×›×œ, ×›×•×œ×œ '×ª××¨×™×¥ ××™×¦×•×™ ×›×•×©×¨ ×”×©×ª×›×¨×•×ª'.", 5000);

        highlight(null);
        await speak("×”××—×©×‘×•×Ÿ ××•×›×Ÿ ×œ×¢×‘×•×“×”. ×ª×”× ×•! âœ¨");
        setTimeout(() => coach.style.display = 'none', 3000);
    }
  </script>
</body>
</html>
